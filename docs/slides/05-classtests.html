<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.280">

  <meta name="author" content="Thomas Petzoldt">
  <meta name="dcterms.date" content="2023-11-16">
  <title>Elements of Data Analysis and Statistics - 05-Classical Tests</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link rel="stylesheet" href="../thpe.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <style>
  #title-slide 
    .title {color: #ee7f00;}
    .subtitle {color: #ee7f00;}
    .quarto-title-author {color: #69af22;}
    .date {color: #69af22;}
  </style>  
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" body-color="#069af22" data-background-image="../img/tud-title-bg-wide-2021.png" class="quarto-title-block center">
  <h1 class="title">05-Classical Tests</h1>
  <p class="subtitle">Applied Statistics – A Practical Course</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Thomas Petzoldt 
</div>
</div>
</div>

  <p class="date">2023-11-16</p>
</section>
<section>
<section id="hypotheses-errors-and-the-p-value" class="title-slide slide level1 center">
<h1>Hypotheses, errors and the p-value</h1>
<!--
ToDo: insert formulae and algorithms from the slides
-->
</section>
<section id="statistical-test" class="slide level2">
<h2>Statistical test</h2>
<p><br></p>
<p>A statistical hypothesis test is a method of statistical inference.</p>
<ul>
<li>Commonly, two samples are compared, or a sample is compared against properties from an idealized model.</li>
<li>A hypothesis <span class="math inline">\(H_a\)</span> for the statistical relationship between the two data sets, is compared to an idealized null hypothesis H0 that proposes no relationship between two data sets.</li>
<li>The comparison is considered statistically significant if the relationship between the data sets would be an unlikely realization of the null hypothesis according to a threshold probability – the significance level.</li>
</ul>
<p>adapted from: <a href="https://en.wikipedia.org/wiki/Statistical%20hypothesis%20testing">https://en.wikipedia.org/wiki/Statistical hypothesis testing</a></p>
</section>
<section id="effect-size-and-significance" class="slide level2">
<h2>Effect size and significance</h2>
<p><br></p>
<p>In case of relative mean differences, the relative effect size is:</p>
<div class="bigfont">
<p><span class="math display">\[
  \delta = \frac{\bar{\mu}_1-\bar{\mu}_2}{\sigma}=\frac{\Delta}{\sigma}
\]</span></p>
</div>
<p>with:</p>
<ul>
<li>mean values of two populations <span class="math inline">\(\mu_1, \mu_2\)</span></li>
<li>effect size <span class="math inline">\(\Delta\)</span></li>
<li>relative effect size <span class="math inline">\(\delta\)</span> (also called Cohen’s d)</li>
<li><strong>significance</strong> means that an observed effect is unlikely the result of pure random variation.</li>
</ul>
</section>
<section id="null-hypothesis-and-alternative-hypothesis" class="slide level2">
<h2>Null hypothesis and alternative hypothesis</h2>
<p><br></p>
<p><span class="blue"><strong><span class="math inline">\(H_0\)</span></strong></span> null hypothesis: two populations are not different with respect to a certain property.</p>
<ul>
<li>Assumption: observed effect occured purely at random, true effect is zero.</li>
</ul>
<p><span class="darkred"><strong><span class="math inline">\(H_a\)</span></strong></span> alternative hypothesis (experimental hypothesis): existence of a certain effect.</p>
<ul>
<li>An alternative hypothesis is never completely true or “proven”.</li>
<li>Acceptance of <span class="math inline">\(H_A\)</span> means only than <span class="math inline">\(H_0\)</span> is unlikely.</li>
</ul>
<p><strong>“Not significant” means either no effect or sample size too small!</strong></p>
<p><br></p>
<p><span class="blue">Note: Different meaning of <strong>significance</strong> (<span class="math inline">\(H_0\)</span> unlikely) and <strong>relevance</strong> (effect large enough to play a role in practice).</span></p>
<!------------------------------------------------------------------------------
## Notes

Statistical tests can only test for differences between samples, not
for equality.  This means that $H_0$ is formulated to be rejected and that it
is impossible to test if two populations are equal -- for principal reasons. If a
test cannot reject "the null", it means only that an observed effect
can also be explained as a result of random variability or error and
that a potential effect was too small to be "significantly"
detected, given the available sample size.

**Important:** Not significant does not necessarily mean "no effect",
it means "no effect or sample size too small"!

Whether an effect is significant or not is determined by comparing the
**p-value** of a test with a pre-defined critical value, the
significance level $\alpha$ (or probability of error).  Here, the
p-value is an estimate for the probability that an observed effect occured at random, 
under the assumption that the null hypothesis is to be true.

------------------------------------------------------------------------------->
</section>
<section id="the-p-value" class="slide level2">
<h2>The p-value</h2>
<p><br></p>
<p>The interpretation of the p-value was often confused in the past, even in statistics textbooks, so it is good to refer to a clear definition:</p>
<div class="bigfont">
<blockquote>
<p>The p-value is defined as the probability of obtaining a result equal to or ‘more extreme’ than what was actually observed, when the null hypothesis is true.</p>
</blockquote>
</div>
<p><br></p>
<ul>
<li><p><a href="https://en.wikipedia.org/wiki/P-value">https://en.wikipedia.org/wiki/P-value</a>:</p></li>
<li><p>Hubbard, R. (2004). Blurring the Distinctions Between p’s and a’s in Psychological Research, Theory Psychology June 2004 vol.&nbsp;14 no. 3 295-327. DOI: <a href="https://doi.org/10.1177/0959354304043638">10.1177/0959354304043638</a></p></li>
</ul>
</section>
<section id="alpha-and-beta-errors" class="slide level2">
<h2>Alpha and beta errors</h2>
<table>
<colgroup>
<col style="width: 26%">
<col style="width: 32%">
<col style="width: 14%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Reality</th>
<th style="text-align: center;">Decision of the test</th>
<th style="text-align: center;">correct?</th>
<th style="text-align: center;">probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(H_0\)</span> = true</td>
<td style="text-align: center;">not significant</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(1-\alpha\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(H_0\)</span> = false</td>
<td style="text-align: center;">significant</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(1-\beta\)</span> (power)</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(H_0\)</span> = true</td>
<td style="text-align: center;">significant</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"><span class="math inline">\(\alpha\)</span>-error</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(H_0\)</span> = false</td>
<td style="text-align: center;">not significant</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"><span class="math inline">\(\beta\)</span>-error</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>1.<span class="math inline">\(H_0\)</span> falsely rejected (error of the first kind or <span class="math inline">\(\alpha\)</span>-error)</p>
<ul>
<li>we claim an effect, that does not exist, e.g.&nbsp;a drug with no effect</li>
</ul>
<p>2.<span class="math inline">\(H_0\)</span> falsely retained (error of the second kind or <span class="math inline">\(\beta\)</span>-error)</p>
<ul>
<li>typical case in small studies, where effect was not enough to detect existing effects</li>
</ul>
<p><strong>Use in practice</strong></p>
<ul>
<li>common convention in environmental sciences: <span class="math inline">\(\alpha=0.05\)</span>, must be set beforehand</li>
<li><span class="math inline">\(\beta=f(\alpha, \text{effectsize}, \text{sample size}, \text{kind of test})\)</span>, should be <span class="math inline">\(\le 0.2\)</span></li>
</ul>
</section>
<section id="significance-and-relevance" class="slide level2">
<h2>Significance and relevance</h2>
<p><br></p>
<p>Significance is not the only important. It is often more important to focus on effect size and relevance.</p>
<p>When evaluating significant effects, it is always necessary to look also at the effect size. While significance means that the null hypothesis <span class="math inline">\(H_0\)</span> is unlikely in a statistical sense, relevance means that the effect size is large enough to play a role in practice. This means that whether an effect can be relevant or not depends on its effect size and the field of application.</p>
<p>Let’s for example consider a vaccination. If a vaccine had a significant effect in a clinical test, but protected only 10 out of 1000 people, one would not consider this effect as relevant and not produce this vaccine.</p>
<p>On the other hand, even small effects can be relevant. So if a toxic substance would have an effect on 1 out of 1000 people to produce cancer, we would consider this as relevant. To detect this as a significant effect would need an epidemiological study with a large number of people. But as it is highly relevant, it is worth the effort.</p>
</section>
<section id="take-home-messages" class="slide level2">
<h2>Take home messages</h2>
<p><br></p>
<ul>
<li>A p-value measures the probability that a purely random effect would be equally or more extreme than an observed effect.</li>
<li>“Significant” means that an observed result is unlikely to have occurred by chance alone.</li>
<li><strong>“Not significant” means either “no effect” or “sample size too small”.</strong></li>
<li>Don’t focus on p-values alone. Never forget to report also sample size, <strong>effect size</strong> and relevance of your results.</li>
<li>With large data sets, the p-value loses importance. It is then easy to find significant effects, but it is often very small and not relevant in practice.</li>
<li>The p-value is an important tool in classical statistics, but its abuse can lead to mis-interpretation.</li>
</ul>
</section></section>
<section>
<section id="differences-between-mean-values" class="title-slide slide level1 center">
<h1>Differences between mean values</h1>

</section>
<section id="one-sample-t-test" class="slide level2">
<h2>One sample t-Test</h2>
<p><br></p>
<ul>
<li>tests if a sample is from a population with given mean value <span class="math inline">\(\mu\)</span></li>
<li>based on checking if the population mean <span class="math inline">\(\mu\)</span> is in the confidence interval of <span class="math inline">\(\bar{x}\)</span></li>
</ul>
<ol type="1">
<li>Let’s assume a sample of size with <span class="math inline">\(n=10, \bar{x}=5.5, s=1\)</span> and <span class="math inline">\(\mu=5\)</span>.</li>
<li>Estimate the 95% confidence interval of <span class="math inline">\(\bar{x}\)</span>:</li>
</ol>
<p><span class="math display">\[
CI = \bar{x} \pm t_{1-\alpha/2, n-1} \cdot s_{\bar{x}}
\]</span> with <span class="math display">\[
s_{\bar{x}} = \frac{s}{\sqrt{n}} \qquad \text{(standard error)}
\]</span></p>
<p>Different ways of calculation shown at the next slides</p>
</section>
<section id="remember-standard-deviation-and-standard-error" class="slide level2">
<h2>Remember: standard deviation and standard error</h2>

<img data-src="05-classtests_files/figure-revealjs/sd-and-se-1.png" width="960" class="r-stretch"><p><small> Visualization of a one-sample t-test. Left: original distribution of the data measured by standard deviation, right: distribution of mean values, measured by its standard error. </small></p>
<p><span class="math display">\[
s_{\bar{x}} = \frac{s}{\sqrt{n}} \qquad \text{(standard error)}
\]</span></p>
<ul>
<li>standard error &lt; standard deviation</li>
<li>measures precision of the mean value</li>
<li>CLT!</li>
</ul>
<p>The test is based on the distribution of the means, not distribution of original data.</p>
</section>
<section id="method-1-is-mu-in-the-confidence-interval" class="slide level2">
<h2>Method 1: Is <span class="math inline">\(\mu\)</span> in the confidence interval?</h2>
<p><br></p>
<ol type="1">
<li><p>Sample: <span class="math inline">\(n=10, \bar{x}=5.5, s=1\)</span> and <span class="math inline">\(\mu=5\)</span></p></li>
<li><p>Let <span class="math inline">\(\alpha = 0.05\)</span>, we get a two-sided 95% confidence interval with:</p></li>
</ol>
<p><span class="math display">\[\bar{x} \pm t_{0,975, n-1} \cdot \frac{s}{\sqrt{n}}\]</span></p>
<div class="bigfont">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fl">5.5</span> <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="dv">10-1</span>) <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.784643 6.215357</code></pre>
</div>
</div>
</div>
<p><br></p>
<ol start="3" type="1">
<li><p>Check if <span class="math inline">\(\mu=5.0\)</span> is in this interval?</p></li>
<li><p>Yes, it <strong>is</strong> inside <span class="math inline">\(\Rightarrow\)</span> <span class="blue">difference not significant</span>.</p></li>
</ol>
</section>
<section id="method-2-comparison-with-a-tabulated-t-value" class="slide level2">
<h2>Method 2: Comparison with a tabulated t-value</h2>
<ol type="1">
<li>Rearrange the equation of the confidence interval, to calculate an observed <span class="math inline">\(t_{obs}\)</span></li>
</ol>
<p><span class="math display">\[
t_{obs} = |\bar{x}-\mu | \cdot \frac{1}{s_{\bar{x}}} = \frac{|\bar{x}-\mu |}{s} \cdot \sqrt{n} = \frac{|5.5 -5.0|}{1.0} \cdot \sqrt{10}
\]</span></p>
<p>We can calculate this in <strong>R</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fl">5.5</span> <span class="sc">-</span> <span class="fl">5.0</span>) <span class="sc">/</span> <span class="fl">1.0</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">10</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.581139</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Compare <span class="math inline">\(t_{obs}\)</span> with a tabulated value</li>
</ol>
<ul>
<li>“Old style”: find critical t-value in a table for given <span class="math inline">\(\alpha\)</span> and degrees of freedom (<span class="math inline">\(n-1\)</span>)</li>
<li>For <span class="math inline">\(\alpha=0.05\)</span> and two-sided, this is: <span class="math inline">\(t_{1-\alpha/2, n-1} = 2.26\)</span>.</li>
</ul>
<p>Comparison: <span class="math inline">\(1.58 &lt; 2.26\)</span> <span class="math inline">\(\Rightarrow\)</span> no significant difference between <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\mu\)</span>.</p>
</section>
<section id="method-3-calculation-of-the-p-value-from-t_obs" class="slide level2">
<h2>Method 3: Calculation of the p-value from <span class="math inline">\(t_{obs}\)</span></h2>
<p><br></p>
<ul>
<li>use computerized probability function (<code>pt</code>) instead of table lookup</li>
<li><span class="math inline">\(t = t_{obs}\)</span> and the degrees of freedom (<span class="math inline">\(n-1\)</span>):</li>
</ul>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(t, <span class="at">df =</span> <span class="dv">10</span> <span class="sc">-</span> <span class="dv">1</span>)) <span class="co"># 2 * (1 - p) is re-arranged from 1-alpha/2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1483047</code></pre>
</div>
</div>
<p>This p-value = 0.1483047 is greater than <span class="math inline">\(0.05\)</span> so we consider the difference as not significant.</p>
<p><br></p>
<p><strong>FAQ: less than or greater than?</strong></p>
<p><br></p>
<table>
<colgroup>
<col style="width: 18%">
<col style="width: 37%">
<col style="width: 29%">
<col style="width: 14%">
</colgroup>
<tbody>
<tr class="odd">
<td>p-value</td>
<td><span class="math inline">\(\text{p-value} &lt; \alpha\)</span></td>
<td>null hypothesis unlikely</td>
<td>significant</td>
</tr>
<tr class="even">
<td>test statistic</td>
<td><span class="math inline">\(t_{obs} &gt; t_{1-\alpha/2, n-1}\)</span></td>
<td>effect exceeds confint.</td>
<td>significant</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="method-4-built-in-t-test-function-in-r" class="slide level2">
<h2>Method 4: Built-in t-test function in R</h2>
<p><br></p>
<p>The same can be done much easier with the computer in <strong>R</strong>.</p>
<p>Let’s assume we have a sample with <span class="math inline">\(\bar{x}=5, s=1\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## define sample</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="fl">3.5</span>, <span class="fl">5.4</span>, <span class="fl">5.3</span>, <span class="dv">6</span>, <span class="fl">7.2</span>, <span class="fl">5.4</span>, <span class="fl">6.3</span>, <span class="fl">4.5</span>, <span class="fl">5.9</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## perform one-sample t-test</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">mu=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  x
t = 1.5811, df = 9, p-value = 0.1483
alternative hypothesis: true mean is not equal to 5
95 percent confidence interval:
 4.784643 6.215357
sample estimates:
mean of x 
      5.5 </code></pre>
</div>
</div>
<p>The test returns the observed t-value, the 95% confidence interval and the p-value.</p>
<p>An important difference is, that this method needs the original data, while the other methods need only mean, standard deviation and sample size.</p>
</section>
<section id="two-sample-t-test" class="slide level2">
<h2>Two sample t-test</h2>
<p><br></p>
<p>The two-sample t-test compares two independent samples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.3</span>, <span class="fl">6.0</span>, <span class="fl">7.1</span>, <span class="fl">6.4</span>, <span class="fl">5.7</span>, <span class="fl">4.9</span>, <span class="fl">5.0</span>, <span class="fl">4.6</span>, <span class="fl">5.7</span>, <span class="fl">4.0</span>, <span class="fl">4.5</span>, <span class="fl">6.5</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.8</span>, <span class="fl">7.1</span>, <span class="fl">5.8</span>, <span class="fl">7.0</span>, <span class="fl">6.7</span>, <span class="fl">7.7</span>, <span class="fl">9.2</span>, <span class="fl">6.0</span>, <span class="fl">7.2</span>, <span class="fl">7.8</span>, <span class="fl">7.8</span>, <span class="fl">5.7</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x1, x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  x1 and x2
t = -3.7185, df = 21.611, p-value = 0.001224
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.3504462 -0.6662205
sample estimates:
mean of x mean of y 
 5.475000  6.983333 </code></pre>
</div>
</div>
<p><br></p>
<ul>
<li><span class="math inline">\(\rightarrow\)</span> both samples differ significantly (<span class="math inline">\(p &lt; 0.05\)</span>)</li>
<li>Note: <strong>R</strong> has not performed the “ordinary” t-test but the Welch test (= heteroscedastic t-test)</li>
<li>where variances of both samples don’t need to be identical.</li>
</ul>
</section>
<section id="hypothesis-and-formula-of-the-two-sample-t-test" class="slide level2">
<h2>Hypothesis and formula of the two-sample t-test</h2>
<p><br></p>
<div class="column" style="width:49%;">
<p><span class="math inline">\(H_0\)</span> <span class="math inline">\(\mu_1 = \mu_2\)</span></p>
<p><span class="math inline">\(H_a\)</span> the two means are different</p>
<p><strong>test criterion</strong></p>
<p><span class="math display">\[
t_{obs} =\frac{|\bar{x}_1-\bar{x}_2|}{s_{tot}} \cdot \sqrt{\frac{n_1 n_2}{n_1+n_2}}
\]</span></p>
</div>
<div class="column" style="width:49%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="05-classtests_files/figure-revealjs/twosample-t-test-1.png" width="960"></p>
</div>
</div>
</div>
<p><strong>pooled standard deviation</strong></p>
<p><span class="math display">\[
s_{tot} = \sqrt{{({n}_1 - 1)\cdot s_1^2 + ({n}_2 - 1)\cdot s_2^2
\over ({n}_1 + {n}_2 - 2)}}
\]</span></p>
<p><strong>assumptions:</strong> independence, equal variances, approximate normal distribution</p>
</section>
<section id="the-welch-test" class="slide level2">
<h2>The Welch test</h2>
<p><br></p>
<p><strong>Known as t-test for samples with unequal variance, works also for equal variance!</strong></p>
<p><br></p>
<p>Test criterion:</p>
<p><span class="math display">\[
t = \frac{\bar{x}_1 - \bar{x}_2}{\sqrt{s^2_{\bar{x}_1} + s^2_{\bar{x}_2}}}
\]</span></p>
<p>Standard error of each sample:</p>
<p><span class="math display">\[
s_{\bar{x}_i} = \frac{s_i}{\sqrt{n_i}}
\]</span> Corrected degrees of freedom:</p>
<p><span class="math display">\[
\text{df} = \frac{\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}}{\frac{s^4_1}{n^2_1(n_1-1)} + \frac{s^4_2}{n^2_2(n_2-1)}}
\]</span></p>
</section></section>
<section>
<section id="welch-test-in-r" class="title-slide slide level1 center">
<h1>Welch test in R</h1>
<div class="bigfont">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x1, x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  x1 and x2
t = -3.7185, df = 21.611, p-value = 0.001224
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.3504462 -0.6662205
sample estimates:
mean of x mean of y 
 5.475000  6.983333 </code></pre>
</div>
</div>
</div>
<p>… is just the default method of the <code>t.test</code>-function.</p>
</section>
<section id="equality-of-variance-f-test" class="slide level2">
<h2>Equality of variance: F-test</h2>
<div class="column" style="width:69%;">
<p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\sigma_1^2 = \sigma_2^2\)</span></p>
<p><span class="math inline">\(H_a\)</span>: variances unequal</p>
<p><strong>Test criterion:</strong></p>
<p><span class="math display">\[F = \frac{s_1^2}{s_2^2} \]</span></p>
<ul>
<li>larger of the two variances in the enumerator <span class="math inline">\((s^2_1 &gt; s^2_2)\)</span></li>
<li>separate degrees of freedom (<span class="math inline">\(n-1\)</span>)</li>
</ul>
</div>
<div class="column" style="width:29%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="05-classtests_files/figure-revealjs/var-homogeneity-1.png" width="384"></p>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<ul>
<li><span class="red"><span class="math inline">\(s_1=1\)</span></span>, <span class="blue"><span class="math inline">\(s_2 =2\)</span></span>, <span class="math inline">\(n_1=5, n_2=10, F=\frac{2^2}{1^2}=4\)</span></li>
<li>deg. of freedom: <span class="math inline">\(9 \atop 4\)</span></li>
</ul>
<p><span class="darkred"><span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\(F_{9, 4, \alpha=0.975} = 8.9 &gt; 4 \quad\rightarrow\)</span> not significant</span></p>
</section>
<section id="homogeneity-of-variances-with-2-samples" class="slide level2">
<h2>Homogeneity of variances with &gt; 2 samples</h2>
<p><br></p>
<div class="column" style="width:59%;">
<div class="cell">

</div>
<div class="cell">

</div>
<p><strong>Bartlett’s test:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(<span class="fu">list</span>(x1, x2, x3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  list(x1, x2, x3)
Bartlett's K-squared = 7.7136, df = 2, p-value = 0.02114</code></pre>
</div>
</div>
<p><br> <strong>Fligner-Killeen test</strong> (recommended):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(<span class="fu">list</span>(x1, x2, x3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fligner-Killeen test of homogeneity of variances

data:  list(x1, x2, x3)
Fligner-Killeen:med chi-squared = 2.2486, df = 2, p-value = 0.3249</code></pre>
</div>
</div>
</div>
<div class="column" style="width:39%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="05-classtests_files/figure-revealjs/three-samples-1.png" width="288"></p>
</div>
</div>
</div>
<ul>
<li>tests are often used to check assumptions of the ANOVA</li>
</ul>
<!------------------------------------------------------------------------------
## Role of the F-test for the classical t-test procedure

The classical procedure would be as follows:

1. Perform a check for the identity of both variances with `var.test` beforehand:


::: {.cell}

```{.r .cell-code}
var.test(x1, x2)  # F-Test
```

::: {.cell-output .cell-output-stdout}
```

    F test to compare two variances

data:  x1 and x2
F = 0.21105, num df = 9, denom df = 9, p-value = 0.02989
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.05242167 0.84968342
sample estimates:
ratio of variances 
         0.2110493 
```
:::
:::



2. if $p < 0.05$ $\Rightarrow$ variances are significantly different $\rightarrow$ Welch test (`var.equal=FALSE`).

3. if $p> 0.05$, $\Rightarrow$ assume equal variances $\rigtarrow$ "ordinary" t-test (`var.equal=TRUE`)


::: {.cell}

```{.r .cell-code}
t.test(x1, x2, var.equal = TRUE) # classical t-test
```

::: {.cell-output .cell-output-stdout}
```

    Two Sample t-test

data:  x1 and x2
t = -0.47421, df = 18, p-value = 0.6411
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.860538  1.175302
sample estimates:
mean of x mean of y 
 5.074626  5.417244 
```
:::
:::

------------------------------------------------------------------------------->
</section>
<section id="recommendation-for-two-sample-t-tests" class="slide level2">
<h2>Recommendation for two sample t-tests</h2>
<p><br></p>
<p><strong>Traditional procedure:</strong></p>
<ol type="1">
<li>Test for equal variances using the F-test: <code>var.test(x, y)</code></li>
<li>If variances are equal: <code>t.test(x, y, var.equal=TRUE)</code></li>
<li>otherwise, use <code>t.test(x, y)</code> (= Welch test)</li>
<li>Check if both samples follow a normal distribution.</li>
</ol>
<p><br></p>
<p><strong>More modern recommendation:</strong></p>
<ol type="1">
<li>Don’t use pre-tests!</li>
<li>Use always the Welch test: <code>t.test(x, y)</code></li>
<li>Check approximate normal distribution by using box-plots. Not necessary if <span class="math inline">\(n\)</span> is large.</li>
</ol>
<p>see also: <a href="https://en.wikipedia.org/wiki/Welch%27s_t-test">Wikipedia</a> and the references cited there</p>
<!--
Zimmerman, D. W. (2004). "A note on preliminary tests of equality of variances". British Journal of Mathematical and Statistical Psychology. 57 (Pt 1): 173–181. doi:10.1348/000711004849222
-->
</section>
<section id="paired-t-test" class="slide level2">
<h2>Paired t-Test</h2>
<ul>
<li><p>sometimes also called “t-test of dependent samples”</p>
<ul>
<li>the term “dependent” can be misleading, better “pairwise”</li>
<li>values within samples must still be independent</li>
</ul></li>
<li><p>examples: left arm / right arm; before / after</p></li>
<li><p>is essentially a one-sample t-test of pairwise differences against <span class="math inline">\(\mu=0\)</span><br>
</p></li>
<li><p>advantage: eliminates “covariate”</p></li>
</ul>
<div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x1, x2, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  x1 and x2
t = -1.372, df = 8, p-value = 0.2073
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -4.28924  1.08924
sample estimates:
mean of x mean of y 
      4.0       5.6 </code></pre>
</div>
</div>
<p>p=0.20, not significant</p>
</div>
<div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">8</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x1, x2, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  x1 and x2
t = -4, df = 4, p-value = 0.01613
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -2.710578 -0.489422
sample estimates:
mean difference 
           -1.6 </code></pre>
</div>
</div>
<p>p=0.016, significant</p>
</div>
<p>It can be seen that the paired t-test has a greater discriminatory power in this case.</p>
</section>
<section id="mann-whitney-and-wilcoxon-test" class="slide level2">
<h2>Mann-Whitney and Wilcoxon-test</h2>
<p><br></p>
<ul>
<li>Non-parametric tests:
<ul>
<li>No assumptions about shape and parameters of distribution, but</li>
<li>distributions should be similar, otherwise test may be misleading.</li>
</ul></li>
<li>Mann-Whitney U-test and Wilcoxon-test are very similar.</li>
<li>In a strict sense, “Wilcoxon” is the version for paired data</li>
</ul>
<p><br> <strong>Basic principle:</strong> Count of so-called “inversions” of ranks, where samples overlap</p>
<ul>
<li>Sample A: 1, 3, 4, 5, 7</li>
<li>Sample B: 6, 8, 9, 10, 11</li>
<li>Both samples ordered together: 1, 3, 4, 5, <span class="red">6</span>, 7, <span class="red">8</span>, <span class="red">9</span>, <span class="red">10</span>, <span class="red">11</span></li>
<li>Inversions: <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(U = 1\)</span></li>
</ul>
</section>
<section id="mann-whitney-test-procedure-in-practice" class="slide level2">
<h2>Mann-Whitney test procedure in practice</h2>
<p><br></p>
<ol type="1">
<li>Assign ranks <span class="math inline">\(R_A\)</span> and <span class="math inline">\(R_B\)</span> to both samples <span class="math inline">\(A\)</span>, and <span class="math inline">\(B\)</span> with sample size <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span>.</li>
<li>Calculate number of inversions <span class="math inline">\(U\)</span>:</li>
</ol>
<p><span class="math display">\[\begin{align*}
     U_A &amp;= m \cdot n + \frac{m (m + 1)}{2} - \sum_{i=1}^m R_A \\
     U_B &amp;= m \cdot n + \frac{n (n + 1)}{2} - \sum_{i=1}^n R_B \\
     U   &amp;= \min(U_A, U_B)
\end{align*}\]</span></p>
<ul>
<li>Critical values of <span class="math inline">\(U\)</span> can be found in common statistics text books.</li>
<li>Not necessary in <strong>R</strong>, p-value directly printed.</li>
<li><strong>Note:</strong> Use special version <code>wilcox.exact</code> with correction if sample has ties.</li>
</ul>
</section>
<section id="mann-whitney---wilcoxon-test-in-r" class="slide level2">
<h2>Mann-Whitney - Wilcoxon-test in R</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(A, B) <span class="co"># use optional argument `paired = TRUE` for paired data.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  A and B
W = 1, p-value = 0.01587
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p><br></p>
<p><strong>Mann-Whitney - Wilcoxon-test with tie correction</strong></p>
<ul>
<li>applied if the rank differences contain doubled values</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"exactRankTests"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.exact</span>(A, B, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact Wilcoxon signed rank test

data:  A and B
V = 0, p-value = 0.0625
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="permutation-methods" class="slide level2">
<h2>Permutation methods</h2>
<ul>
<li>Basic principle: Estimation of a test statistic <span class="math inline">\(\xi_{obs}\)</span> from sample,</li>
<li>Resampling: Simulate many <span class="math inline">\(\xi_{i, sim}\)</span> from randomly permuted data set (<span class="math inline">\(n = 999\)</span> or more)</li>
<li>Where does <span class="math inline">\(\xi_{est}\)</span> appear within the ordered series of simulated values <span class="math inline">\(\xi_{i, sim}\)</span>?</li>
</ul>

<img data-src="05-classtests_files/figure-revealjs/permutation-test-1.png" width="960" class="r-stretch quarto-figure-center"><p>Let <span class="math inline">\(\xi_{obs}\)</span> be <span class="math inline">\(4.5\)</span> in our example, then <span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\(p= 0.97\)</span>.</p>
</section></section>
<section>
<section id="test-for-distributions" class="title-slide slide level1 center">
<h1>Test for distributions</h1>

</section>
<section id="testing-for-distributions" class="slide level2">
<h2>Testing for distributions</h2>
<p><strong>Nominal variables</strong></p>
<ul>
<li><span class="math inline">\(\chi^2\)</span>-test</li>
<li>Fisher’s exact test</li>
</ul>
<p><strong>Ordinal variables</strong></p>
<ul>
<li>Cramér-von-Mises-Test</li>
<li><span class="math inline">\(\rightarrow\)</span> more powerful than <span class="math inline">\(\chi^2\)</span> or KS-test</li>
</ul>
<p><strong>Metric scales</strong></p>
<ul>
<li>Kolmogorov-Smirnov-Test (KS-test)</li>
<li>Shapiro-Wilks-Test (for normal distribution)</li>
</ul>
</section>
<section id="contingency-tables-for-nominal-variables" class="slide level2">
<h2>Contingency tables for nominal variables</h2>
<ul>
<li>used for nominal (i.e.&nbsp;categorical or qualitative) data</li>
<li>examples: eye and hair color, medical treatment and the number of cured/not cured</li>
<li>important: use <strong>absolute mesurements</strong> (true numbers!), not percentages or other calculated data (e.g.&nbsp;not something like biomass per area)</li>
</ul>
<p><strong>Data example</strong></p>
<ul>
<li><em>Daphnia</em> (water flee)-clones and their preferred depth in a lake</li>
<li>food algae in the deep water zone, poor of oxygen</li>
<li>only adapted clones with high haemoglobin can dive into deep water</li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Clone</th>
<th style="text-align: center;">Upper layer</th>
<th style="text-align: center;">Deep layer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">A</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">87</td>
</tr>
<tr class="even">
<td style="text-align: right;">B</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">78</td>
</tr>
<tr class="odd">
<td style="text-align: right;">C</td>
<td style="text-align: center;">72</td>
<td style="text-align: center;">45</td>
</tr>
</tbody>
</table>
</section>
<section id="calculation-of-the-chi2-test" class="slide level2">
<h2>Calculation of the <span class="math inline">\(\chi^2\)</span>-test</h2>
<ol type="1">
<li>Observed frequencies <span class="math inline">\(O_{ij}\)</span> and sums of rows and columns:</li>
</ol>
<table>
<thead>
<tr class="header">
<th></th>
<th>Clone A</th>
<th>Clone B</th>
<th>Clone C</th>
<th>Sum <span class="math inline">\(s_i\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Epilimnion</td>
<td>50</td>
<td>37</td>
<td>72</td>
<td>159</td>
</tr>
<tr class="even">
<td>Hypolimnion</td>
<td>87</td>
<td>78</td>
<td>45</td>
<td>210</td>
</tr>
<tr class="odd">
<td>Sum {<span class="math inline">\(s_j\)</span>}</td>
<td>137</td>
<td>115</td>
<td>117</td>
<td><span class="math inline">\(n=369\)</span></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ol start="2" type="1">
<li>Expected frequencies <span class="math inline">\(E_{ij}\)</span> under the <span class="math inline">\(H_0\)</span>: <span class="math inline">\({\mathbf E = s_i \otimes s_j} / n\)</span></li>
</ol>
<table>
<thead>
<tr class="header">
<th></th>
<th>Clone A</th>
<th>Clone B</th>
<th>Clone C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Epilimnion</td>
<td>59.0</td>
<td>49.6</td>
<td>50.4</td>
</tr>
<tr class="even">
<td>Hypolimnion</td>
<td>78.0</td>
<td>65.4</td>
<td>66.6</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ol start="3" type="1">
<li>Calculate <span class="math inline">\(\hat{\chi}^2 = \sum_{i, j} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}\)</span> with <span class="math inline">\((n_{row} - 1) \cdot (n_{col} - 1)\)</span> degrees of freedom.</li>
</ol>
<ul>
<li>Compare with critical <span class="math inline">\(\chi^2\)</span> from table.</li>
<li>Note: The results are only reliable if all observed frequencies are$ $.</li>
<li>For smaller samples, use Fisher’s exact test</li>
</ul>
</section>
<section id="the-chi2-test-in-r" class="slide level2">
<h2>The <span class="math inline">\(\chi^2\)</span>-test in <strong>R</strong></h2>
<p><br></p>
<p>Organize data in a matrix with 3 rows (for the clones) and 2 columns (for the depths):</p>
<div class="bigfont">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">37</span>, <span class="dv">72</span>, <span class="dv">87</span>, <span class="dv">78</span>, <span class="dv">45</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   50   87
[2,]   37   78
[3,]   72   45</code></pre>
</div>
</div>
</div>
<div class="bigfont">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  x
X-squared = 24.255, df = 2, p-value = 5.408e-06</code></pre>
</div>
</div>
</div>
</section>
<section id="fishers-exact-test" class="slide level2">
<h2>Fisher’s exact test</h2>
<p><br></p>
<div class="bigfont">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">37</span>, <span class="dv">72</span>, <span class="dv">87</span>, <span class="dv">78</span>, <span class="dv">45</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   50   87
[2,]   37   78
[3,]   72   45</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  x
p-value = 5.807e-06
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
<p><br></p>
<p><span class="math inline">\(\rightarrow\)</span> significant correlation between the clones and their location.</p>
<ul>
<li>dependency between clones and vertical distribution in the lake</li>
</ul>
</section>
<section id="favorite-numbers-of-hse-students" class="slide level2">
<h2>Favorite numbers of HSE students</h2>

<img data-src="05-classtests_files/figure-revealjs/favorite-numbers-1.png" width="960" class="r-stretch"><ul>
<li>Numbers from 1..9, <span class="math inline">\(n=34\)</span></li>
<li><span class="math inline">\(H_0\)</span>: equal probability of all numbers <span class="math inline">\(1/9\)</span> (discrete uniform distribution)</li>
<li><span class="math inline">\(H_A\)</span>: some numbers are favored <span class="math inline">\(\rightarrow\)</span> departure from discrete uniform</li>
</ul>
</section>
<section id="chisquare-test" class="slide level2">
<h2>Chisquare test</h2>
<p><br></p>
<div class="bigfont">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>obsfreq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">3</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(obsfreq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  obsfreq
X-squared = 13.647, df = 8, p-value = 0.09144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(obsfreq, <span class="at">simulate.p.value=</span><span class="cn">TRUE</span>, <span class="at">B=</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities with simulated p-value (based
    on 1000 replicates)

data:  obsfreq
X-squared = 13.647, df = NA, p-value = 0.0969</code></pre>
</div>
</div>
</div>
<p><br></p>
<ul>
<li><strong>one-sample</strong> <span class="math inline">\(\chi^2\)</span>-test. It tests for equality of frequency in all classes.</li>
<li>The simulation-based version of the test (with 1000 replicates) is slightly more precise than the standard <span class="math inline">\(\chi^2\)</span>-test, but both ar not significant.</li>
</ul>
</section>
<section id="cramér-von-mises-test" class="slide level2">
<h2>Cramér-von-Mises-Test</h2>

<img data-src="05-classtests_files/figure-revealjs/von-mises-1.png" width="960" class="r-stretch"><p><span class="math display">\[
T = n \omega^2 = \frac{1}{12n} + \sum_{i=1}^n \left[ \frac{2i-1}{2n}-F(x_i) \right]^2
\]</span></p>
</section>
<section id="cramér-von-mises-test-in-r" class="slide level2">
<h2>Cramér-von-Mises-Test in <strong>R</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dgof)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>obsfreq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">3</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="do">## CvM-test needs individual values, not class frequencies</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(obsfreq), obsfreq)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 2 3 3 3 3 3 3 4 4 5 5 6 6 6 6 6 7 7 7 7 7 7 7 7 8 8 8 8 8 8 9 9 9</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## create a cumulative function with equal probability of all cases</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">stepfun</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">9</span>, <span class="dv">9</span>))))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="do">## perform the test</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cvm.test</span>(x, cdf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Cramer-von Mises - W2

data:  x
W2 = 0.51658, p-value = 0.03665
alternative hypothesis: Two.sided</code></pre>
</div>
</div>
<ul>
<li>The Cramér-von-Mises-test works with the original, unbinned values</li>
<li>Use of cumulative function <span class="blue">respects order of classes</span> <span class="math inline">\(\rightarrow\)</span> more powerful, than <span class="math inline">\(\chi^2\)</span>-test.</li>
</ul>
</section>
<section id="test-distribution-type-of-metric-variables" class="slide level2">
<h2>Test distribution type of metric variables</h2>

<img data-src="05-classtests_files/figure-revealjs/normality-graphical-1.png" width="960" class="r-stretch quarto-figure-center"><p><br></p>
<ul>
<li>histogram, boxplot, quantile-quantile plot</li>
<li>Shapiro Wilk W-test</li>
<li>Box-Cox method</li>
<li>see section <strong>Distributions</strong></li>
</ul>
</section></section>
<section>
<section id="dependency-and-correlation" class="title-slide slide level1 center">
<h1>Dependency and correlation</h1>

</section>
<section id="correlation" class="slide level2">
<h2>Correlation</h2>
<p><br></p>
<p><strong>Frequencies of nominal variables</strong></p>
<ul>
<li><span class="math inline">\(\chi^2\)</span>-test</li>
<li>Fisher’s exact test</li>
</ul>
<p>⇒ dependence between plant society and soil type</p>
<p><span class="gray">(see before)</span></p>
<p><strong>Ordinal variables</strong></p>
<ul>
<li>Spearman-Correlation</li>
</ul>
<p><span class="math inline">\(\rightarrow\)</span> rank numbers</p>
<p><strong>Metric scales</strong></p>
<ul>
<li>Pearson-correlation</li>
<li>Spearman-correlation</li>
</ul>
</section>
<section id="variance-and-covariance" class="slide level2">
<h2>Variance and Covariance</h2>
<p><br></p>
<div class="column" style="width:59%;">
<p><strong>Variance</strong></p>
<ul>
<li>measures variation of a single variable</li>
</ul>
<p><span class="math display">\[
  s^2_x = \frac{\text{sum of squares}}{\text{degrees of freedom}}=\frac{\sum_{i=1}^n (x_i-\bar{x})^2}{n-1}
\]</span></p>
<p><strong>Covariance</strong></p>
<ul>
<li>measures how two variables change together</li>
</ul>
<p><span class="math display">\[
  q_{x,y} = \frac{\sum_{i=1}^n (x_i-\bar{x})(y_i-\bar{y})}{n-1}
\]</span></p>
<p>Correlation: scaled to <span class="math inline">\((-1, +1)\)</span></p>
<p><span class="math display">\[
  r_{x,y} = \frac{q_{x,y}}{s_x \cdot s_y}
\]</span></p>
</div>
<div class="column" style="width:39%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="05-classtests_files/figure-revealjs/var-covar-1.png" width="288"></p>
</div>
</div>
</div>
</section>
<section id="correlation-coefficient-after-pearson" class="slide level2">
<h2>Correlation coefficient after Pearson</h2>
<p><br></p>
<div class="column" style="width:69%;">
<ul>
<li>the usual correlation coefficient that we all know</li>
<li>tests for <span class="blue">linear dependence</span></li>
</ul>
<p><span class="math display">\[
r_p=\frac{\sum{(x_i-\bar{x})  (y_i-\bar{y})}}
       {\sqrt{\sum(x_i-\bar{x})^2\sum(y_i-\bar{y})^2}}
\]</span></p>
<p><strong>Or:</strong></p>
<p><span class="math display">\[
r_p=\frac {\sum xy - \sum y \sum y / n}
        {\sqrt{(\sum x^2-(\sum x)^2/n)(\sum y^2-(\sum y)^2/n)}}
\]</span> <br></p>
<p>Range of values: <span class="math inline">\(-1 \le r_p \le +1\)</span></p>
<table>
<tbody>
<tr class="odd">
<td><span class="math inline">\(0\)</span></td>
<td>no interdependence</td>
</tr>
<tr class="even">
<td><span class="math inline">\(+1 \,\text{or}\,-1\)</span></td>
<td>strictly positive resp. negative dependence</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0 &lt; |r_p| &lt; 1\)</span></td>
<td>positive resp. negative dependence</td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="column" style="width:29%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="05-classtests_files/figure-revealjs/pearson1-1.png" width="384"></p>
</div>
</div>
</div>
</section>
<section id="which-size-of-correlation-indicates-dependency" class="slide level2">
<h2>Which size of correlation indicates dependency?</h2>
<div class="column" style="width:49%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="05-classtests_files/figure-revealjs/pearson2-1.png" width="480"></p>
</div>
</div>
<p><span class="math inline">\(r=0.4, \quad p=0.0039\)</span></p>
</div>
<div class="column" style="width:49%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="05-classtests_files/figure-revealjs/pearson3-1.png" width="480"></p>
</div>
</div>
<p><span class="math inline">\(r=0.85, \quad p=0.07\)</span></p>
</div>
</section>
<section id="significant-correlation" class="slide level2">
<h2>Significant correlation?</h2>
<p><span class="math display">\[
\hat{t}_{\alpha/2;n-2} =\frac{|r_p|\sqrt{n-2}}{\sqrt{1-r^2_P}}
\]</span></p>
<p><span class="math inline">\(t=0.829 \cdot \sqrt{1000-2}/\sqrt{1-0.829^2}=46.86, df=998\)</span></p>
<p><br> <strong>Quick test: critical values for <span class="math inline">\(r_p\)</span></strong></p>
<table>
<tbody>
<tr class="odd">
<td style="text-align: right;"><span class="math inline">\(n\)</span></td>
<td style="text-align: right;">d.f.</td>
<td style="text-align: right;"><span class="math inline">\(t\)</span></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.706</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3.182</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2.306</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">2.101</td>
</tr>
<tr class="even">
<td style="text-align: right;">50</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2.011</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">1.984</td>
</tr>
<tr class="even">
<td style="text-align: right;">1000</td>
<td style="text-align: right;">998</td>
<td style="text-align: right;">1.962</td>
</tr>
<tr class="odd">
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</section>
<section id="rank-correlation-according-to-spearman" class="slide level2">
<h2>Rank-correlation according to Spearman</h2>
<p><br></p>
<ul>
<li>measures <strong>monotonous</strong> (and not necessarily linear) dependence</li>
<li>estimation from rank differences:</li>
</ul>
<p><span class="math display">\[
r_s=1-\frac{6 \sum d^2_i}{n(n^2-1)}
\]</span></p>
<ul>
<li>or, alternatively: Pearson-correlation of ranked data (necessary in case of ties).</li>
<li>Test: for <span class="math inline">\(n &lt; 10\)</span> <span class="math inline">\(\rightarrow\)</span> table of critical values</li>
</ul>
<p>for <span class="math inline">\(10 \leq n\)</span> <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(t\)</span>-distribution</p>
<p><span class="math display">\[
   \hat{t}_{1-\frac{\alpha}{2};n-2}
      =\frac{|r_s|}{\sqrt{1-r^2_S}} \sqrt{n-2}
\]</span></p>

<aside><div>
<p>Computer statistics packages use a special algorithm (algorithm AS 89 according to Best and Roberts, 1975).</p>
</div></aside></section>
<section id="example" class="slide level2">
<h2>Example</h2>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(x\)</span></th>
<th style="text-align: right;"><span class="math inline">\(y\)</span></th>
<th><span class="math inline">\(R_x\)</span></th>
<th><span class="math inline">\(R_y\)</span></th>
<th><span class="math inline">\(d\)</span></th>
<th><span class="math inline">\(d^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td style="text-align: right;">2.7</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: right;">7.4</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: right;">20.1</td>
<td>3</td>
<td>3</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td style="text-align: right;">500.0</td>
<td>4</td>
<td>5</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>5</td>
<td style="text-align: right;">148.4</td>
<td>5</td>
<td>4</td>
<td>+1</td>
<td>1</td>
</tr>
<tr class="even">
<td></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td>2</td>
</tr>
<tr class="odd">
<td></td>
<td style="text-align: right;"></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
r_s=1-\frac{6 \cdot 2}{5\cdot (25-1)}=1-\frac{12}{120}=0.9
\]</span></p>
<p>For comparison: <span class="math inline">\(r_p=0.58\)</span></p>
</section>
<section id="application-of-spearmans-r_s" class="slide level2">
<h2>Application of Spearman’s-<span class="math inline">\(r_s\)</span></h2>
<p><br></p>
<p><strong>Advantages</strong></p>
<ul>
<li>distribution free (does not require normal distribution),</li>
<li>detects any dependence,</li>
<li>not much affected by outliers.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>certain information loss due to ranking,</li>
<li>no information about type of dependency,</li>
<li>no direct relationship to coefficient of determination.</li>
</ul>
<p>Conclusion: <span class="math inline">\(r_s\)</span> is nevertheless highly recommended!</p>
</section>
<section id="correlation-coefficients-in-r" class="slide level2">
<h2>Correlation coefficients in <strong>R</strong></h2>
<ul>
<li>Pearson’s product-moment correlation coefficient</li>
<li>Spearman’s rank correlation coefficient</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>,  <span class="dv">9</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">11</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x, y, <span class="at">method=</span><span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  x and y
t = 7.969, df = 4, p-value = 0.001344
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.7439930 0.9968284
sample estimates:
      cor 
0.9699203 </code></pre>
</div>
</div>
<p>If linearity or normality of residuals is doubtful, use a rank correlation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x, y, <span class="at">method=</span><span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  x and y
S = 2, p-value = 0.01667
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.9428571 </code></pre>
</div>
</div>
</section>
<section id="problematic-cases" class="slide level2">
<h2>Problematic cases</h2>

<img data-src="05-classtests_files/figure-revealjs/cor-violations-1.png" width="576" class="r-stretch"></section>
<section id="outlook-more-than-two-independent-variables" class="slide level2">
<h2>Outlook: More than two independent variables</h2>
<p><br></p>
<p><strong>Multiple correlation</strong></p>
<ul>
<li><span class="blue">Example:</span> Chl-a=<span class="math inline">\(f(x_1, x_2, x_3, x_4, \dots)\)</span>, where <span class="math inline">\(x_i\)</span> is the biomass of the <span class="math inline">\(i\)</span>th phytoplankton species.</li>
<li>multiple correlation coefficient</li>
<li>partial correlation coefficient</li>
<li>attractive method <span class="math inline">\(\leftrightarrow\)</span> but difficult in practice:
<ul>
<li>“independent” variables may correlate with each other (multi-collinearity) <span class="math inline">\(\Rightarrow\)</span> bias of the multiple <span class="math inline">\(r\)</span>.</li>
<li>non-linearities are even more difficult to handle than in the two-sample case.</li>
</ul></li>
</ul>
<p><strong>Recommendation:</strong></p>
<ul>
<li>Use multivariate Methods (NMDS, PCA, …) for a first overview,</li>
<li>apply multiple regression with care and use process knowledge.</li>
</ul>
</section></section>
<section>
<section id="power-analysis" class="title-slide slide level1 center">
<h1>Power Analysis</h1>

</section>
<section id="determining-the-power-of-statistical-tests" class="slide level2">
<h2>Determining the power of statistical tests</h2>
<p><br></p>
<p><strong>How many replicates will I need?</strong></p>
<ul>
<li><p>Depends on:</p>
<ul>
<li>the relative effect size: effect/standard deviation</li>
</ul>
<p><span class="math display">\[\delta=\frac{(\bar{x}_1-\bar{x}_2)}{s}\]</span></p>
<ul>
<li>the sample size <span class="math inline">\(n\)</span>,</li>
<li>and the pre-defined significance level <span class="math inline">\(\alpha\)</span>.</li>
<li>and the used method</li>
</ul></li>
<li><p>The smaller <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(n\)</span> and <span class="math inline">\(\Delta\)</span>, the bigger the type II error (<span class="math inline">\(\beta\)</span> error).</p></li>
<li><p>This is the probability to overlook effects despite of their existence.</p></li>
</ul>
</section>
<section id="power-analysis-1" class="slide level2">
<h2>Power analysis</h2>
<p><br></p>
<p>Formula for minimum sample size in the one-sample case:</p>
<p><span class="math display">\[
n = \bigg(\frac{z_\alpha + z_{1-\beta}}{\Delta}\bigg)^2
\]</span></p>
<ul>
<li><span class="math inline">\(z\)</span>: the quantiles (<code>qnorm</code>) of the standard normal distribution for <span class="math inline">\(\alpha\)</span> and for <span class="math inline">\(1-\beta\)</span></li>
<li><span class="math inline">\(\delta=\Delta / s\)</span>: relative effect size.</li>
</ul>
<p><strong>Example</strong></p>
<p>Two-tailed test with <span class="math inline">\(\alpha=0.025\)</span> and <span class="math inline">\(\beta=0.2\)</span></p>
<p><span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(z_\alpha = 1.96\)</span>, <span class="math inline">\(z_\beta=0.84\)</span>, then:</p>
<p><span class="math display">\[
n= (1.96 \pm 0.84)^2 \cdot 1/\delta^2 \approx 8 /\delta^2
\]</span></p>
</section>
<section id="power-of-the-t-test" class="slide level2">
<h2>Power of the t-test</h2>
<p>The power of a t-test, or the minimum sample size, can be calculated with: <code>power.t.test()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">delta=</span><span class="fl">0.5</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Two-sample t test power calculation 

              n = 5
          delta = 0.5
             sd = 1
      sig.level = 0.05
          power = 0.1038399
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
</div>
</div>
<p><span class="math inline">\(\rightarrow\)</span> power = 0.10</p>
<ul>
<li>For <span class="math inline">\(n=5\)</span> an existing effect of <span class="math inline">\(0.5\sigma\)</span> is only detected in 1 out of 10 cases.</li>
<li>For a power of 80% at <span class="math inline">\(n=5\)</span> we need an effect size of at least <span class="math inline">\(2\sigma\)</span>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">n=</span><span class="dv">5</span>, <span class="at">power=</span><span class="fl">0.8</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For a weak effect of <span class="math inline">\(0.5\sigma\)</span> we need a sample size of <span class="math inline">\(n\ge64\)</span> in each group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power.t.test</span>(<span class="at">delta=</span><span class="fl">0.5</span>,<span class="at">power=</span><span class="fl">0.8</span>,<span class="at">sig.level=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="darkred"><span class="math inline">\(\Rightarrow\)</span> we ned either a large sample size or a strong effect.</span></p>
</section>
<section id="simulated-power-of-a-t-test" class="slide level2">
<h2>Simulated power of a t-test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># population parameters</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>n      <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>xmean1 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>xmean2 <span class="ot">&lt;-</span> <span class="dv">55</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>xsd1   <span class="ot">&lt;-</span> xsd2 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>alpha  <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># number of test runs in the simulation</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>nn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nn) {</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating random numbers</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, xmean1, xsd1)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, xmean2, xsd2)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># results of the t-test</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x1,x2,<span class="at">var.equal =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value </span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p <span class="sc">&lt;</span> alpha) {</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>     a <span class="ot">&lt;-</span> a<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>   } <span class="cf">else</span> {</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>     b <span class="ot">&lt;-</span> b<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"a="</span>, a, <span class="st">", b="</span>, b, <span class="st">", a/n="</span>, a<span class="sc">/</span>nn, <span class="st">", b/n="</span>, b<span class="sc">/</span>nn))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>