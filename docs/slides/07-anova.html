<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.280">

  <meta name="author" content="Thomas Petzoldt">
  <meta name="dcterms.date" content="2023-11-04">
  <title>Elements of Data Analysis and Statistics - 07-One and two-way ANOVA</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link rel="stylesheet" href="../thpe.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
  <style>
  #title-slide 
    .title {color: #ee7f00;}
    .subtitle {color: #ee7f00;}
    .quarto-title-author {color: #69af22;}
    .date {color: #69af22;}
  </style>  
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" body-color="#069af22" data-background-image="../img/tud-title-bg-wide-2021.png" class="quarto-title-block center">
  <h1 class="title">07-One and two-way ANOVA</h1>
  <p class="subtitle">Applied Statistics – A Practical Course</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Thomas Petzoldt 
</div>
</div>
</div>

  <p class="date">2023-11-04</p>
</section>
<section id="anova-analysis-of-variances" class="slide level2">
<h2>ANOVA – Analysis of Variances</h2>
<p><br></p>
<ul>
<li>Testing of complex hypothesis as a whole, e.g.:
<ul>
<li>more than two samples (multiple test problem),</li>
<li>several multiple factors (multiway ANOVA)</li>
<li>elimination of covariates (ANCOVA)</li>
<li>fixed and/or random effects (variance decomposition methods, mixed effects models)</li>
</ul></li>
<li>Different application scenarios:
<ul>
<li>explorative use: Which influence factors are important?</li>
<li>descriptive use: Fitting of models for process description and forecasting.</li>
<li>significance tests.</li>
</ul></li>
<li>ANOVA methods are (in most cases) based on linear models.</li>
</ul>
</section>
<section id="a-practical-example" class="slide level2">
<h2>A practical example</h2>
<div class="column" style="width:49%;">
<p><span class="darkred">Find a suitable medium for growth experiments with green algae</span></p>
<ul>
<li>cheap, easy to handle</li>
<li>suitable for students courses and classroom experiments</li>
</ul>
</div>
<div class="column" style="width:49%;">
<p><img data-src="../img/ansaetze.jpg"></p>
</div>
<p><strong>Idea</strong></p>
<ul>
<li>use a commercial fertilizer with the main nutrients N and P</li>
<li>mineral water with trace elements</li>
<li>does non-sparkling mineral water contain enough <span class="math inline">\(\mathrm{CO_2}\)</span>?</li>
<li>test how to improve (<span class="math inline">\(\mathrm{CO_2}\)</span>) availability for photosynthesis</li>
</ul>
</section>
<section id="application" class="slide level2">
<h2>Application</h2>
<p><br></p>
<p><strong>7 Different treatments</strong></p>
<p><br></p>
<ol type="1">
<li>fertilizer solution in closed bottles</li>
<li>fertilizer solution in open bottles (<span class="math inline">\(\mathrm{CO_2}\)</span> from air)</li>
<li>fertilizer + sugar (organic C source)</li>
<li>fertilizer + additional <span class="math inline">\(\mathrm{HCO_3^-}\)</span> (add <span class="math inline">\(\mathrm{CaCO_3}\)</span> to sparkling mineral water)</li>
<li>a standard algae growth medium (“Basal medium”) for comparison</li>
<li>deionized (“destilled”) water and</li>
<li>tap water for comparison</li>
</ol>
</section>
<section id="experimental-design" class="slide level2">
<h2>Experimental design</h2>

<img data-src="../img/ruettler.jpg" alt="bottles with algae on a shaker" class="r-stretch quarto-figure-center"><ul>
<li>each treatment with 3 replicates</li>
<li>randomized placement on a shaker</li>
<li>16:8 light:dark-cycle</li>
<li>measurement directly in the bottles using a self-made <a href="https://tpetzoldt.github.io/growthlab/doc/versuchsaufbau.html">turbidity meter</a></li>
</ul>
</section>
<section id="results" class="slide level2">
<h2>Results</h2>
<div class="vbox">

</div>
<div class="hbox">
<p><img data-src="../img/ansaetze2.jpg"> Fertilizer – Open Bottle – F. + Sugar – F. + CaCO3 – Basal medium – A. dest – Tap water</p>
</div>
</section>
<section id="the-data-set" class="slide level2">
<h2>The data set</h2>
<p><br></p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-algae-growth">

<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;"><caption>Table&nbsp;1:  Growth from day 2 to day 6 (relative units) </caption>
 <thead>
  <tr>
   <th style="text-align:left;"> treat </th>
   <th style="text-align:right;"> replicate 1 </th>
   <th style="text-align:right;"> replicate 2 </th>
   <th style="text-align:right;"> replicate 3 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Fertilizer </td>
   <td style="text-align:right;"> 0.020 </td>
   <td style="text-align:right;"> -0.217 </td>
   <td style="text-align:right;"> -0.273 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F. open </td>
   <td style="text-align:right;"> 0.940 </td>
   <td style="text-align:right;"> 0.780 </td>
   <td style="text-align:right;"> 0.555 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F.+sugar </td>
   <td style="text-align:right;"> 0.188 </td>
   <td style="text-align:right;"> -0.100 </td>
   <td style="text-align:right;"> 0.020 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F.+CaCO3 </td>
   <td style="text-align:right;"> 0.245 </td>
   <td style="text-align:right;"> 0.236 </td>
   <td style="text-align:right;"> 0.456 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Bas.med. </td>
   <td style="text-align:right;"> 0.699 </td>
   <td style="text-align:right;"> 0.727 </td>
   <td style="text-align:right;"> 0.656 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A.dest </td>
   <td style="text-align:right;"> -0.010 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> -0.010 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Tap water </td>
   <td style="text-align:right;"> 0.030 </td>
   <td style="text-align:right;"> -0.070 </td>
   <td style="text-align:right;"> NA </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><span class="red">NA</span> means “not available”, i.e.&nbsp;a missing value</li>
<li>the crosstable structure is compact and esy to read, but not suitable for data analysis</li>
<li><span class="math inline">\(\Rightarrow\)</span> convert it to long format</li>
</ul>
</section>
<section id="data-in-long-format" class="slide level2">
<h2>Data in long format</h2>
<div class="column" style="width:59%;">
<p><br></p>
<h3 id="advantages">Advantages</h3>
<ul>
<li>looks “stupid” but is better for data analysis</li>
<li>dependent variable <strong>growth</strong> and <br>explanation variable <strong>treat</strong> clearly visible</li>
<li>model formula: <code>growth ~ treat</code></li>
<li>easily extensible to <span class="math inline">\(&gt;1\)</span> explanation variable</li>
</ul>
</div>
<div class="column" style="width:39%;">
<div class="cell">
<div class="cell-output-display">

<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> treat </th>
   <th style="text-align:right;"> rep </th>
   <th style="text-align:right;"> growth </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Fertilizer </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.020 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Fertilizer </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> -0.217 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Fertilizer </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> -0.273 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F. open </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.940 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F. open </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.780 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F. open </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.555 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F.+sugar </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.188 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F.+sugar </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> -0.100 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F.+sugar </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.020 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F.+CaCO3 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.245 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F.+CaCO3 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 0.236 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> F.+CaCO3 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 0.456 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="the-data-in-r" class="slide level2">
<h2>The data in R</h2>
<p><br><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>algae <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">treat  =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"Fertilizer"</span>, <span class="st">"Fertilizer"</span>, <span class="st">"Fertilizer"</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">"F. open"</span>, <span class="st">"F. open"</span>, <span class="st">"F. open"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"F.+sugar"</span>, <span class="st">"F.+sugar"</span>, <span class="st">"F.+sugar"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"F.+CaCO3"</span>, <span class="st">"F.+CaCO3"</span>, <span class="st">"F.+CaCO3"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Bas.med."</span>, <span class="st">"Bas.med."</span>, <span class="st">"Bas.med."</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"A.dest"</span>, <span class="st">"A.dest"</span>, <span class="st">"A.dest"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Tap water"</span>, <span class="st">"Tap water"</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Fertilizer"</span>, <span class="st">"F. open"</span>, <span class="st">"F.+sugar"</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"F.+CaCO3"</span>, <span class="st">"Bas.med."</span>, <span class="st">"A.dest"</span>, <span class="st">"Tap water"</span>)),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">rep   =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">growth =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="sc">-</span><span class="fl">0.217</span>, <span class="sc">-</span><span class="fl">0.273</span>, <span class="fl">0.94</span>, <span class="fl">0.78</span>, <span class="fl">0.555</span>, <span class="fl">0.188</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.02</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>             <span class="fl">0.245</span>, <span class="fl">0.236</span>, <span class="fl">0.456</span>, <span class="fl">0.699</span>, <span class="fl">0.727</span>, <span class="fl">0.656</span>, <span class="sc">-</span><span class="fl">0.01</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.01</span>, <span class="fl">0.03</span>, <span class="sc">-</span><span class="fl">0.07</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>… can be entered directly in the code. A csv-file in long format is also possible.</p>
</section>
<section id="boxplot" class="slide level2">
<h2>Boxplot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(growth <span class="sc">~</span> treat, <span class="at">data =</span> algae)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>, <span class="at">col =</span> <span class="st">"grey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="07-anova_files/figure-revealjs/algae-boxplot-1.png" width="960" class="r-stretch"></section>
<section id="stripchart" class="slide level2">
<h2>Stripchart</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(growth <span class="sc">~</span> treat, <span class="at">data =</span> algae, <span class="at">vertical =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="07-anova_files/figure-revealjs/algae-stripchart-1.png" width="960" class="r-stretch"><p>Better, because we have only 2-3 replicates. Boxplot needs more.</p>
</section>
<section id="turn-scientific-question-into-a-statistical-hypothesis" class="slide level2">
<h2>Turn scientific question into a statistical hypothesis</h2>
<p><br></p>
<p><strong>Scientific Questions</strong></p>
<ul>
<li>Are the treatments different?</li>
<li>Which medium is the best?</li>
<li>Is the best medium significantly better than the others?</li>
</ul>
<p><br> <strong>Statistical Hypotheses</strong></p>
<ul>
<li><span class="math inline">\(H_0\)</span>: growth is the same in all treatments</li>
<li><span class="math inline">\(H_A\)</span>: differences between media</li>
</ul>
</section>
<section id="why-cant-we-apply-just-several-t-tests" class="slide level2">
<h2>Why can’t we apply just several t-tests?</h2>
<p><br></p>
<ul>
<li>If we have 7 treatments and want to test all against each other, we would need:</li>
</ul>
<p><span class="math display">\[7 \cdot (7 - 1) / 2 = 21 \qquad\text{tests.}\]</span></p>
<ul>
<li>If we set <span class="math inline">\(\alpha = 0.05\)</span> we get 5% false positives. <span class="math inline">\(\Rightarrow\)</span> <span class="red">One</span> of 20 tests is on average a <span class="red">false positive</span></li>
<li>If we do <span class="math inline">\(N\)</span> tests, we increase the overall <span class="math inline">\(\alpha\)</span> error to <span class="math inline">\(N\cdot\alpha\)</span> in the worst case.</li>
<li>This is called <strong>alpha-error-inflation</strong> or the <strong>Bonferroni</strong> law:</li>
</ul>
<p><span class="math display">\[
\alpha_{total} \le \sum_{i=1}^{N} \alpha_i = N \cdot \alpha
\]</span></p>
<p>If we ignore the Bonferroni law, we end in <strong>statistical fishing</strong> and get spurious results just by chance. See <a href="https://xkcd.com/882/">https://xkcd.com/882/</a>.</p>
</section>
<section>
<section id="solutions" class="title-slide slide level1 center">
<h1>Solutions</h1>
<div class="bigfont">
<ol type="1">
<li>Down-correct the alpha errors so that <span class="math inline">\(\alpha_{total} = 0.05\)</span>.<br> <span class="math inline">\(\rightarrow\)</span> Bonferroni rule.</li>
<li>Use a method that does all tests simultanaeously: the ANOVA.</li>
</ol>
</div>
</section>
<section id="anova-analysis-of-variances-1" class="slide level2">
<h2>ANOVA: Analysis of variances</h2>
<p><br></p>
<p><strong>Basic Idea</strong></p>
<ul>
<li>Split the total variance into effect(s) and errors:</li>
</ul>
<div class="bigfont">
<p><span class="math display">\[
s_y^2 = s^2_\mathrm{effect} + s^2_{\varepsilon}
\]</span></p>
</div>
<ul>
<li>Somewhat surprising: we use variances to compare mean values.</li>
<li><strong>Explanation:</strong> differences of means contribute to the total variance of the whole sample.</li>
<li>Variance components can be called <strong>variance within</strong> (<span class="math inline">\(s^2_\varepsilon\)</span>) and variance <strong>between</strong> samples.</li>
<li>The way how to separate variances is a <span class="blue">linear model</span>.</li>
</ul>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<p><br></p>
<p>Two brands of Clementine fruits from a shop “E”, that we encode as “EB” and “EP”. We want to know whether the premium brand (“P”) and the basic brand (“B”) have a different weight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>clem <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">brand =</span> <span class="fu">c</span>(<span class="st">"EP"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EB"</span>, <span class="st">"EP"</span>, <span class="st">"EP"</span>, <span class="st">"EP"</span>, <span class="st">"EP"</span>, <span class="st">"EP"</span>, <span class="st">"EP"</span>, <span class="st">"EP"</span>, <span class="st">"EB"</span>, <span class="st">"EP"</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">88</span>, <span class="dv">96</span>, <span class="dv">100</span>, <span class="dv">96</span>, <span class="dv">90</span>, <span class="dv">100</span>, <span class="dv">92</span>, <span class="dv">92</span>, <span class="dv">102</span>, <span class="dv">99</span>, <span class="dv">86</span>, <span class="dv">89</span>, <span class="dv">99</span>, <span class="dv">89</span>, <span class="dv">75</span>, <span class="dv">80</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>             <span class="dv">81</span>, <span class="dv">96</span>, <span class="dv">82</span>, <span class="dv">98</span>, <span class="dv">80</span>, <span class="dv">107</span>, <span class="dv">88</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br> We encode one sample (“EB”) with 1 and the other sample (“EP”) with 2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>clem<span class="sc">$</span>code <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(clem<span class="sc">$</span>brand))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>clem<span class="sc">$</span>code</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 1 2</code></pre>
</div>
</div>
</section>
<section id="then-we-fit-a-linear-regression" class="slide level2">
<h2>Then we fit a linear regression:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weight <span class="sc">~</span> code, <span class="at">data =</span> clem, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> code, <span class="at">data =</span> clem)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"EB"</span>, <span class="st">"EP"</span>)); <span class="fu">axis</span>(<span class="dv">2</span>); <span class="fu">box</span>()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(m, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="07-anova_files/figure-revealjs/eb-ep-linear-1.png" width="960" class="r-stretch"></section>
<section id="variance-components" class="slide level2">
<h2>Variance components</h2>
<p><br></p>
<p>We fit a linear model and compare the variances:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> code, <span class="at">data =</span> clem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>total variance</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(var_tot <span class="ot">&lt;-</span> <span class="fu">var</span>(clem<span class="sc">$</span>weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 68.98814</code></pre>
</div>
</div>
<p><strong>residual variance (= within variance)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(var_res <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">residuals</span>(m)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43.25</code></pre>
</div>
</div>
<p><strong>explained variance (= between variance)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>var_tot <span class="sc">-</span> var_res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 25.73814</code></pre>
</div>
</div>
<p>Now we can analyse whether the between variance is big enough to justify a significant effect.</p>
<p>This is called an ANOVA.</p>
</section>
<section id="anova" class="slide level2">
<h2>ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: weight
          Df Sum Sq Mean Sq F value   Pr(&gt;F)   
code       1 566.24  566.24  12.497 0.001963 **
Residuals 21 951.50   45.31                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><br></p>
<p><strong>A t-test for comparison</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(weight <span class="sc">~</span> code, <span class="at">data =</span> clem, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  weight by code
t = 3.5351, df = 21, p-value = 0.001963
alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
95 percent confidence interval:
  4.185911 16.147423
sample estimates:
mean in group 1 mean in group 2 
       95.50000        85.33333 </code></pre>
</div>
</div>
<p><span class="math inline">\(\Rightarrow\)</span> the p-values are exactly the same.</p>
</section>
<section id="anova-with-more-than-2-samples" class="slide level2">
<h2>ANOVA with more than 2 samples</h2>
<p>Back to the algae growth data. Let’s call the linear model <code>m</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> treat, <span class="at">data =</span> algae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<ul>
<li>We can print the coefficients of the linear model with <code>summary(m)</code></li>
<li>But we are interested in the overall effect and use <code>anova</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: growth
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
treat      6 2.35441 0.39240  25.045 1.987e-06 ***
Residuals 13 0.20368 0.01567                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>The ANOVA table shows F-tests testing for significance of all factors.</li>
<li>In the table above, we have only one single factor.</li>
</ul>
<p><span class="math inline">\(\Rightarrow\)</span> We see that the treatment had a significant effect.</p>
</section>
<section id="posthoc-tests" class="slide level2">
<h2>Posthoc tests</h2>
<ul>
<li>The test showed, that the <strong>factor</strong> “treatment” had a significant effect.</li>
<li>We don’t know yet, which <strong>factor levels</strong> were different.</li>
</ul>
<p><strong>Tukey HSD test</strong> is the most common.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tk <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(m))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>tk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = m)

$treat
                            diff         lwr         upr     p adj
F. open-Fertilizer    0.91500000  0.56202797  1.26797203 0.0000103
F.+sugar-Fertilizer   0.19266667 -0.16030537  0.54563870 0.5211198
F.+CaCO3-Fertilizer   0.46900000  0.11602797  0.82197203 0.0069447
Bas.med.-Fertilizer   0.85066667  0.49769463  1.20363870 0.0000231
A.dest-Fertilizer     0.15000000 -0.20297203  0.50297203 0.7579063
Tap water-Fertilizer  0.13666667 -0.25796806  0.53130140 0.8837597
F.+sugar-F. open     -0.72233333 -1.07530537 -0.36936130 0.0001312
F.+CaCO3-F. open     -0.44600000 -0.79897203 -0.09302797 0.0102557
Bas.med.-F. open     -0.06433333 -0.41730537  0.28863870 0.9943994
A.dest-F. open       -0.76500000 -1.11797203 -0.41202797 0.0000721
Tap water-F. open    -0.77833333 -1.17296806 -0.38369860 0.0001913
F.+CaCO3-F.+sugar     0.27633333 -0.07663870  0.62930537 0.1727182
Bas.med.-F.+sugar     0.65800000  0.30502797  1.01097203 0.0003363
A.dest-F.+sugar      -0.04266667 -0.39563870  0.31030537 0.9994197
Tap water-F.+sugar   -0.05600000 -0.45063473  0.33863473 0.9985686
Bas.med.-F.+CaCO3     0.38166667  0.02869463  0.73463870 0.0307459
A.dest-F.+CaCO3      -0.31900000 -0.67197203  0.03397203 0.0879106
Tap water-F.+CaCO3   -0.33233333 -0.72696806  0.06230140 0.1247914
A.dest-Bas.med.      -0.70066667 -1.05363870 -0.34769463 0.0001792
Tap water-Bas.med.   -0.71400000 -1.10863473 -0.31936527 0.0004507
Tap water-A.dest     -0.01333333 -0.40796806  0.38130140 0.9999997</code></pre>
</div>
</div>
</section>
<section id="graphical-output" class="slide level2">
<h2>Graphical output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">las =</span> <span class="dv">1</span>)             <span class="co"># las = 1 make y annotation horizontal</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">1</span>)) <span class="co"># more space at the left for axis annotation</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="07-anova_files/figure-revealjs/algae-tukey-1.png" width="960" class="r-stretch"></section>
<section id="anova-assumptions-and-diagnostics" class="slide level2">
<h2>ANOVA assumptions and diagnostics</h2>
<div class="column" style="width:49%;">
<p>ANOVA has same assumptions as the linear model.</p>
<p><br></p>
<ol type="1">
<li>Independence of errors</li>
<li>Variance homogeneity</li>
<li>Approximate normality of errors</li>
</ol>
<p>Graphical checks are preferred.</p>
</div>
<div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="07-anova_files/figure-revealjs/algae-diagnostics-1.png" width="480"></p>
</div>
</div>
</div>
</section>
<section id="numerical-tests" class="slide level2">
<h2>Numerical tests</h2>
<p><br><br></p>
<div class="column" style="width:49%;">
<p><strong>Test variance homogeneity</strong></p>
<ul>
<li>F-test compares only two variances.</li>
<li>Several tests for multiple variances available, e.g.&nbsp;Bartlett, Levene, Fligner-Killeen</li>
<li>Recommended: Fligner-Killeen-test</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(growth <span class="sc">~</span> treat, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> algae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fligner-Killeen test of homogeneity of variances

data:  growth by treat
Fligner-Killeen:med chi-squared = 4.2095, df = 6, p-value = 0.6483</code></pre>
</div>
</div>
</div>
<div class="column" style="width:49%;">
<p><strong>Test of normal distribution</strong></p>
<ul>
<li>The Shapiro-Wilks test can be misleading.</li>
<li>Use a graphical method!</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="07-anova_files/figure-revealjs/algae-qqnorm-1.png" width="576"></p>
</div>
</div>
</div>
</section>
<section id="one-way-anova-with-heterogeneous-variances" class="slide level2">
<h2>One-way ANOVA with heterogeneous variances</h2>
<p><br><br></p>
<ul>
<li>extension of the Welch test for <span class="math inline">\(\ge 2\)</span> samples</li>
<li>in R called <code>oneway.test</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(growth <span class="sc">~</span> treat, <span class="at">data =</span> algae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  growth and treat
F = 115.09, num df = 6.0000, denom df = 4.6224, p-value = 6.57e-05</code></pre>
</div>
</div>
</section>
<section id="two-way-anova" class="slide level2">
<h2>Two-way ANOVA</h2>
<div class="cell">

</div>
<ul>
<li>Example from a statistics text book <span class="citation" data-cites="Crawley2002">(<a href="#/bibliography" role="doc-biblioref" onclick="">Crawley, 2002</a>)</span></li>
<li>Effects of diet and coat color on growth of Hamsters in gramm per time</li>
</ul>
<table>
<thead>
<tr class="header">
<th>diet</th>
<th>light coat</th>
<th>dark coat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>8.3</td>
<td>6.6</td>
</tr>
<tr class="even">
<td>A</td>
<td>8.7</td>
<td>7.2</td>
</tr>
<tr class="odd">
<td>B</td>
<td>8.1</td>
<td>6.9</td>
</tr>
<tr class="even">
<td>B</td>
<td>8.5</td>
<td>8.3</td>
</tr>
<tr class="odd">
<td>C</td>
<td>9.1</td>
<td>7.9</td>
</tr>
<tr class="even">
<td>C</td>
<td>9.0</td>
<td>9.2</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>factorial experiment (<strong>with replicates</strong>): each factor combination has more than one observation.</li>
<li>without replication:
<ul>
<li>no replicates per factor combination</li>
<li>this is possible, but does not allow identification of interactions</li>
</ul></li>
</ul>
</section>
<section id="enter-data-in-long-format" class="slide level2">
<h2>Enter data in long format</h2>
<div class="column" style="width:59%;">
<p><br><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>hams <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">No =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">growth =</span> <span class="fu">c</span>(<span class="fl">6.6</span>, <span class="fl">7.2</span>, <span class="fl">6.9</span>, <span class="fl">8.3</span>, <span class="fl">7.9</span>, <span class="fl">9.2</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fl">8.3</span>, <span class="fl">8.7</span>, <span class="fl">8.1</span>, <span class="fl">8.5</span>, <span class="fl">9.1</span>, <span class="fl">9.0</span>),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diet =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each=</span><span class="dv">2</span>),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">coat =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"light"</span>, <span class="st">"dark"</span>), <span class="at">each=</span><span class="dv">6</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="column" style="width:39%;">
<div class="cell">
<div class="cell-output-display">

<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> No </th>
   <th style="text-align:right;"> growth </th>
   <th style="text-align:left;"> diet </th>
   <th style="text-align:left;"> coat </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 6.6 </td>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> light </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 7.2 </td>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> light </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 6.9 </td>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> light </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 4 </td>
   <td style="text-align:right;"> 8.3 </td>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> light </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 5 </td>
   <td style="text-align:right;"> 7.9 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> light </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 9.2 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> light </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 8.3 </td>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> dark </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 8.7 </td>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> dark </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 8.1 </td>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> dark </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 8.5 </td>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> dark </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 11 </td>
   <td style="text-align:right;"> 9.1 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> dark </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 12 </td>
   <td style="text-align:right;"> 9.0 </td>
   <td style="text-align:left;"> C </td>
   <td style="text-align:left;"> dark </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="linear-model-and-anova" class="slide level2">
<h2>Linear model and ANOVA</h2>

<img data-src="07-anova_files/figure-revealjs/hams-boxplot-1.png" width="960" class="r-stretch quarto-figure-center"><p><strong>ANOVA</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> coat <span class="sc">*</span> diet, <span class="at">data =</span> hams)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: growth
          Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
coat       1 2.61333 2.61333  7.2258 0.03614 *
diet       2 2.66000 1.33000  3.6774 0.09069 .
coat:diet  2 0.68667 0.34333  0.9493 0.43833  
Residuals  6 2.17000 0.36167                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="interaction-plot" class="slide level2">
<h2>Interaction plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(hams, <span class="fu">interaction.plot</span>(diet, coat, growth, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"brown"</span>, <span class="st">"orange"</span>), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="07-anova_files/figure-revealjs/hams-interaction-1.png" width="960" class="r-stretch"></section>
<section id="diagnostics" class="slide level2">
<h2>Diagnostics</h2>
<p><strong>Assumptions</strong></p>
<ol type="1">
<li>Independence of measurements (within samples)</li>
<li>Variance homogeneity of residuals</li>
<li>Normal distribution of residuals</li>
</ol>
<p><br> <span class="red">Test of assumptions needs residuals of the fitted model.</span> <span class="math inline">\(\Rightarrow\)</span> Fit the ANOVA model first, then check if it was correct!</p>
<p><br></p>
<p><strong>Diagnostic tools</strong></p>
<ul>
<li>Box plot</li>
<li>Plot of residuals vs.&nbsp;mean values</li>
<li>Q-Q-plot of residuals</li>
<li>Fligner-Killeen test (alternative: some people recommend the Levene-Test)</li>
</ul>
</section>
<section id="diagnostics-ii" class="slide level2">
<h2>Diagnostics II</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(m))</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(m)<span class="sc">~</span><span class="fu">fitted</span>(m))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="07-anova_files/figure-revealjs/hams-diagnostics-1.png" width="960" class="r-stretch quarto-figure-center"><div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(growth <span class="sc">~</span> <span class="fu">interaction</span>(coat, diet), <span class="at">data=</span>hams)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fligner-Killeen test of homogeneity of variances

data:  growth by interaction(coat, diet)
Fligner-Killeen:med chi-squared = 10.788, df = 5, p-value = 0.05575</code></pre>
</div>
</div>
<p>Residuals: look ok and p-value of the Fligner test <span class="math inline">\(&lt; 0.05\)</span>, <span class="math inline">\(\rightarrow\)</span> looks fine.</p>
</section>
<section id="notes" class="slide level2">
<h2>Notes</h2>
<p><strong>Linear regression or ANOVA?</strong></p>
<ul>
<li>essentially the same</li>
<li>independent variables are <strong>metric</strong>: linear model</li>
<li>independent variables are nominal (= factor): ANOVA</li>
<li>mix of metric and nominal variables: ANCOVA</li>
</ul>
<p><strong>Use of pre-tests</strong></p>
<p>Pre-tests are in general questionable for theoretical reasons:</p>
<ol type="1">
<li>The null hypotheses <span class="math inline">\(H_0\)</span> can only be rejected and not ultimately confirmed.</li>
<li>If the sample size is large, normality of residuals is not required</li>
<li>If <span class="math inline">\(p\)</span> is close to the threshold and sample size is small, we would be left in uncertainty.</li>
</ol>
<p>All this can only be overcome with careful thinking and some experience.</p>
<p>It is always a good idea to discuss results with colleagues and supervisors.</p>
</section>
<section id="sequential-holm-bonferroni-method" class="slide level2">
<h2>Sequential Holm-Bonferroni method</h2>
<ul>
<li>Also called Holm procedure <span class="citation" data-cites="Holm1979">(<a href="#/bibliography" role="doc-biblioref" onclick="">Holm, 1979</a>)</span></li>
<li>Easy to use</li>
<li>Can be applied to any multiple test problem</li>
<li>Less conservative that ordinary Bonferroni correction, but …</li>
<li>… still a very conservative approach</li>
<li>see also <a href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">Wikipedia</a></li>
</ul>
<p><strong>Algorithm</strong></p>
<ol type="1">
<li>Select smallest <span class="math inline">\(p\)</span> out of all <span class="math inline">\(n\)</span> <span class="math inline">\(p\)</span>-values</li>
<li>If <span class="math inline">\(p \cdot n &lt; \alpha\)</span> <span class="math inline">\(\Rightarrow\)</span> significant, else <bf>STOP</bf></li>
<li>Set <span class="math inline">\(n − 1 \rightarrow n\)</span>, remove smallest <span class="math inline">\(p\)</span> from the list and go to step 1.</li>
</ol>
</section>
<section id="example-1" class="slide level2">
<h2>Example</h2>
<p>Growth rate per day (<span class="math inline">\(d^{-1}\)</span>) of blue-green algae cultures (<em>Pseudanabaena</em>) after adding toxic peptides from another blue-green algae (<em>Microcystis</em>).</p>
<p>The original hypothesis was that Microcystin LR (MCYST) or a derivative of it (Substance A) inhibits growth.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mcyst <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">treat =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Control"</span>, <span class="dv">5</span>),</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">rep</span>(<span class="st">"MCYST"</span>, <span class="dv">5</span>),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">rep</span>(<span class="st">"Subst A"</span>, <span class="dv">5</span>)),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Control"</span>, <span class="st">"MCYST"</span>, <span class="st">"Subst A"</span>)),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mu   =</span> <span class="fu">c</span>(<span class="fl">0.086</span>, <span class="fl">0.101</span>, <span class="fl">0.086</span>, <span class="fl">0.086</span>, <span class="fl">0.099</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                               <span class="fl">0.092</span>, <span class="fl">0.088</span>, <span class="fl">0.093</span>, <span class="fl">0.088</span>, <span class="fl">0.086</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                               <span class="fl">0.095</span>, <span class="fl">0.102</span>, <span class="fl">0.106</span>, <span class="fl">0.106</span>, <span class="fl">0.106</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="approach-1-one-way-anova" class="slide level2">
<h2>Approach 1: one-way ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(mu <span class="sc">~</span> treat, <span class="at">data=</span>mcyst)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: mu
          Df     Sum Sq    Mean Sq F value   Pr(&gt;F)   
treat      2 0.00053293 2.6647e-04   8.775 0.004485 **
Residuals 12 0.00036440 3.0367e-05                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(m)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="07-anova_files/figure-revealjs/mcyst-tukey-1.png" width="960" class="r-stretch"></section>
<section id="approach-2-multiple-t-tests-with-sequential-bonferroni-correction" class="slide level2">
<h2>Approach 2: multiple t-Tests with sequential Bonferroni correction</h2>
<p>We separate the data set in single subsets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>Control <span class="ot">&lt;-</span> mcyst<span class="sc">$</span>mu[mcyst<span class="sc">$</span>treat <span class="sc">==</span> <span class="st">"Control"</span>]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>MCYST   <span class="ot">&lt;-</span> mcyst<span class="sc">$</span>mu[mcyst<span class="sc">$</span>treat <span class="sc">==</span> <span class="st">"MCYST"</span>]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>SubstA  <span class="ot">&lt;-</span> mcyst<span class="sc">$</span>mu[mcyst<span class="sc">$</span>treat <span class="sc">==</span> <span class="st">"Subst A"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and perform 3 t-Tests:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Control, MCYST)<span class="sc">$</span>p.value</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(Control, SubstA)<span class="sc">$</span>p.value</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(MCYST, SubstA)<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The following shows the raw p-values without correction:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p1, p2, p3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.576275261 0.027378832 0.001190592</code></pre>
</div>
</div>
<p>and with Holm correction:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p.adjust</span>(<span class="fu">c</span>(p1, p2, p3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.576275261 0.054757664 0.003571775</code></pre>
</div>
</div>
</section>
<section id="conclusions" class="slide level2">
<h2>Conclusions</h2>
<p><strong>Statistical methods</strong></p>
<ul>
<li>In case of Holm-corrected t-tests, only a single p-value (MCYST vs.&nbsp;Subst A) remains significant. This indicates that in this case, Holm’s method is more conservative than TukeyHSD (only one compared to two significant) effects.</li>
<li>An ANOVA with posthoc test is in general preferred,</li>
<li>but the sequential Holm-Bonferroni can be helpful in special cases.</li>
<li>Moreover, it demonstrates clearly that massive multiple testing needs to be avoided.</li>
</ul>
<p><span class="math inline">\(\Rightarrow\)</span> ANOVA is to be preferred, when possible.</p>
<p><strong>Interpretation</strong></p>
<ul>
<li>Regarding our original hypothesis, we can see that MCYST and SubstA did not inhibit growth of <em>Pseudanabaena</em>. In fact SubstA stimulated growth.</li>
<li>This was contrary to our expectations – the biological reason was then found 10 years later.</li>
</ul>
<p>More about this can be found in <span class="citation" data-cites="Jahnichen2001">Jähnichen et al. (<a href="#/bibliography" role="doc-biblioref" onclick="">2001</a>)</span>, <span class="citation" data-cites="Jahnichen2007">Jähnichen et al. (<a href="#/bibliography" role="doc-biblioref" onclick="">2007</a>)</span>, <span class="citation" data-cites="Jahnichen2011">Jähnichen et al. (<a href="#/bibliography" role="doc-biblioref" onclick="">2011</a>)</span>, <span class="citation" data-cites="Zilliges2011">Zilliges et al. (<a href="#/bibliography" role="doc-biblioref" onclick="">2011</a>)</span> or <span class="citation" data-cites="Dziallas2011">Dziallas &amp; Grossart (<a href="#/bibliography" role="doc-biblioref" onclick="">2011</a>)</span>.</p>
</section>
<section id="ancova" class="slide level2">
<h2>ANCOVA</h2>
<p><strong>Statistical question</strong></p>
<ul>
<li>Comparison of regression lines</li>
<li>Similar to ANOVA, but contains also <strong>metric</strong> variables (covariates)</li>
</ul>
<p><strong>Example</strong></p>
<p>Annette Dobson’s birthweight data. A data set from a statistics textbook <span class="citation" data-cites="Dobson2013">(<a href="#/bibliography" role="doc-biblioref" onclick="">Dobson, 2013</a>)</span>, birth weight of boys and girls in dependence of the pregnancy week.</p>

<img data-src="07-anova_files/figure-revealjs/dobson-lines-1.png" width="960" class="r-stretch"></section>
<section id="the-birthweight-data-set" class="slide level2">
<h2>The birthweight data set</h2>
<p>The data set is found at different places on the internet and in different versions.</p>
<p>Here the version that is found in an R demo: <code>demo(lm.glm)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Birth Weight Data see stats/demo/lm.glm.R</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>dobson <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">week =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">38</span>, <span class="dv">40</span>, <span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">37</span>, <span class="dv">41</span>, <span class="dv">40</span>, <span class="dv">37</span>, <span class="dv">38</span>, <span class="dv">40</span>, <span class="dv">38</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>     <span class="dv">40</span>, <span class="dv">36</span>, <span class="dv">40</span>, <span class="dv">38</span>, <span class="dv">42</span>, <span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">37</span>, <span class="dv">36</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">40</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">2968</span>, <span class="dv">2795</span>, <span class="dv">3163</span>, <span class="dv">2925</span>, <span class="dv">2625</span>, <span class="dv">2847</span>, <span class="dv">3292</span>, <span class="dv">3473</span>, <span class="dv">2628</span>, <span class="dv">3176</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="dv">3421</span>, <span class="dv">2975</span>, <span class="dv">3317</span>, <span class="dv">2729</span>, <span class="dv">2935</span>, <span class="dv">2754</span>, <span class="dv">3210</span>, <span class="dv">2817</span>, <span class="dv">3126</span>, <span class="dv">2539</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>        <span class="dv">2412</span>, <span class="dv">2991</span>, <span class="dv">2875</span>, <span class="dv">3231</span>),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">12</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"M"</span>, <span class="st">"F"</span>))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!------------------------------------------------------------------------------
## Linear regression, ANOVA and ANCOVA


* ANCOVA (analysis of covariance) deals with the comparison of regression lines
* Simply speaking, we can distinguish the following:
    * independent variables have metric scale: linear regression
    * independent variables all nominal (factor): ANOVA
    * independent variables are mixed nominal and metric: ANCOVA
    
For the linear models discussed so far, the **dependent** variable is always 
metric, while binary or nominal dependent variables can be handled with generalized
linear models (GLM).
------------------------------------------------------------------------------->
</section>
<section id="anette-dobsons-birthweight-data" class="slide level2">
<h2>Anette Dobson’s birthweight data</h2>
<p>Why not just using a t-test?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(weight <span class="sc">~</span> sex,<span class="at">data=</span>dobson, <span class="at">ylab=</span><span class="st">"weight"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(weight <span class="sc">~</span> sex, <span class="at">data=</span>dobson, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  weight by sex
t = 0.97747, df = 22, p-value = 0.339
alternative hypothesis: true difference in means between group M and group F is not equal to 0
95 percent confidence interval:
 -126.3753  351.7086
sample estimates:
mean in group M mean in group F 
       3024.000        2911.333 </code></pre>
</div>
</div>
<img data-src="07-anova_files/figure-revealjs/dobson-boxplot-1.png" width="960" class="r-stretch quarto-figure-center"><p>The box plot shows much overlap and the difference is not significant, because the t-test ignores important information: the pregnancy week.</p>
</section>
<section id="ancova-makes-use-of-covariates" class="slide level2">
<h2>ANCOVA makes use of covariates</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> week <span class="sc">*</span> sex, <span class="at">data =</span> dobson)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: weight
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
week       1 1013799 1013799 31.0779 1.862e-05 ***
sex        1  157304  157304  4.8221   0.04006 *  
week:sex   1    6346    6346  0.1945   0.66389    
Residuals 20  652425   32621                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>

<!---------------------
## How this works


::: {.cell}

```{.r .cell-code}
plot(weight ~ week, data=dobson, col=c("blue","red")[as.numeric(sex)], pch=16)

#summary(m)
p <- coef(m)

## lines fitted by the ANCOVA
abline(a=p[1],      b=p[2],      col="red")
abline(a=p[1]+p[3], b=p[2]+p[4], col="blue")

## the result is the same as when we would fit separate linear models
fem <- lm(weight ~ week, data=dobson, subset = sex=="F")
mal <- lm(weight ~ week, data=dobson, subset = sex=="M")
abline(fem, col="black", lty="dashed")
abline(mal, col="black", lty="dashed")
```
:::

--------------------------->
<img data-src="07-anova_files/figure-revealjs/dobson-ancova-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="pitfalls-of-anova-and-ancova-described-so-far" class="slide level2">
<h2>Pitfalls of ANOVA and ANCOVA described so far</h2>
<p><br></p>
<ol type="1">
<li>Heterogeneity of variance
<ul>
<li>p-values can be biased (i.e.&nbsp;misleading or wrong)</li>
<li>use of a one-way ANOVA for uneaqual variances (in R: <code>oneway.test</code>)</li>
</ul></li>
<li>Unbalanced case:<br> unequal number of samples for each factor combination<br> <span class="math inline">\(\rightarrow\)</span> ANOVA results depend on the order of factors in the model formula.
<ul>
<li>Classical method: Type II or Type III ANOVA</li>
<li>Modern approach: model selection and likelihood ratio tests</li>
</ul></li>
</ol>
</section>
<section id="type-ii-and-type-iii-anova" class="slide level2">
<h2>Type II and type III ANOVA</h2>
<p><br></p>
<ul>
<li>function <code>Anova</code> (with upper case <code>A</code>) in package <strong>car</strong></li>
<li>Help file of function <code>Anova</code>:</li>
</ul>
<blockquote>
<p>“Type-II tests are calculated according to the principle of marginality, testing each term after all others, except ignoring the term’s higher-order relatives; so-called type-III tests violate marginality, testing each term in the model after all of the others.”</p>
</blockquote>
<ul>
<li>Conclusion:<br> use Type II and don’t try to interpret single terms in case of significant interactions.</li>
</ul>
</section>
<section id="type-ii-anova-example" class="slide level2">
<h2>Type II ANOVA: Example</h2>

<img data-src="07-anova_files/figure-revealjs/hams-boxplot-ancova-1.png" width="960" class="r-stretch"><div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"car"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> coat <span class="sc">*</span> diet, <span class="at">data =</span> hams)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m, <span class="at">type=</span><span class="st">"II"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: growth
           Sum Sq Df F value  Pr(&gt;F)  
coat      2.61333  1  7.2258 0.03614 *
diet      2.66000  2  3.6774 0.09069 .
coat:diet 0.68667  2  0.9493 0.43833  
Residuals 2.17000  6                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="model-selection-a-paradigm-change" class="slide level2">
<h2>Model selection – a paradigm change</h2>
<p><br></p>
<p><strong>Problem:</strong></p>
<ul>
<li>In complicated models, p-values depend on number (and sometimes of order) of included factors and interactions.</li>
<li>The <span class="math inline">\(H_0\)</span>-based approach becomes confusing, e.g.&nbsp;because of contradictory p-values.</li>
</ul>
<p><strong>Alternative approach:</strong></p>
<p>Comparison of different model candidates instead of p-value based testing.</p>
<ul>
<li>Model with all potentiall effects → <span style="color:blue">full model</span>,</li>
<li>Omit single factors → <span style="color:blue">reduced models</span> (several!),</li>
<li>No influence factors (ony mean value) → <span style="color:blue">null model</span>.</li>
<li>Which model is the best → <span style="color:blue">minimal adequate model</span>?</li>
</ul>
</section>
<section id="how-can-we-measure-which-model-is-the-best" class="slide level2">
<h2>How can we measure which model is the best?</h2>
<p><br></p>
<p>Compromise between model fit and model complexity (number of parameters, k).</p>
<ul>
<li>Goodness of fit: Likelihood L (measures how good the data match a given model).</li>
<li>Log Likelihood: makes the criterion additive.</li>
<li>AIC (Akaike Information Criterion):</li>
</ul>
<p><span class="math display">\[AIC = −2 \ln(L) + 2k\]</span></p>
<ul>
<li>BIC (Bayesian Information Criterion), takes sample size into account (<span class="math inline">\(n\)</span>):</li>
</ul>
<p><span class="math display">\[BIC = −2 \ln(L) + k · \ln(n)\]</span></p>
<p>The model with the smallest AIC (or BIC) is the <span style="color:blue">minimal adequate</span> (i.e.&nbsp;optimal) model.</p>
</section></section>
<section>
<section id="self-study" class="title-slide slide level1 center">
<h1>Self study</h1>
<p>Read the paper of <span class="citation" data-cites="JohnsonOmland2004">Johnson &amp; Omland (<a href="#/bibliography" role="doc-biblioref" onclick="">2004</a>)</span> to gain more understanding of the model selection paradigm.</p>
<p><a href="https://doi.org/10.1016/j.tree.2003.10.013">https://doi.org/10.1016/j.tree.2003.10.013</a></p>
</section>
<section id="model-selection-and-likelihood-ratio-tests" class="slide level2">
<h2>Model Selection and Likelihood Ratio Tests</h2>
<p><strong>Approach</strong></p>
<ol type="1">
<li>Fit several models individually</li>
<li>Compare the models pairwise with ANOVA (likelihood ratio test)</li>
</ol>
<p><strong>Data and example</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>hams <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">No=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">growth=</span><span class="fu">c</span>(<span class="fl">6.6</span>, <span class="fl">7.2</span>, <span class="fl">6.9</span>, <span class="fl">8.3</span>, <span class="fl">7.9</span>, <span class="fl">9.2</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                            <span class="fl">8.3</span>, <span class="fl">8.7</span>, <span class="fl">8.1</span>, <span class="fl">8.5</span>, <span class="fl">9.1</span>, <span class="fl">9.0</span>),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diet=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each=</span><span class="dv">2</span>),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">coat=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"light"</span>, <span class="st">"dark"</span>), <span class="at">each=</span><span class="dv">6</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> diet <span class="sc">*</span> coat, <span class="at">data=</span>hams)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> diet <span class="sc">+</span> coat, <span class="at">data=</span>hams)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1, m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: growth ~ diet * coat
Model 2: growth ~ diet + coat
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1      6 2.1700                           
2      8 2.8567 -2  -0.68667 0.9493 0.4383</code></pre>
</div>
</div>
<ul>
<li>Likelihood ratio test compares two models (<code>anova</code> with &gt; 1 model)</li>
<li>Model with interaction (<code>m1</code>) not significantly better than model without interaction (<code>m2</code>).</li>
</ul>
</section>
<section id="aic-based-model-selection" class="slide level2">
<h2>AIC-based model selection</h2>
<p><br></p>
<p>Pairwise model comparison is cumbersome, especially for large number of models.</p>
<p><strong>Solution</strong></p>
<p>Use Akaike Information Criterion and select the optimal (or: <span class="blue">minimal adequate</span>) model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(m1, m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   df      AIC
m1  7 27.53237
m2  5 26.83151</code></pre>
</div>
</div>
<p><strong>Conclusion:</strong> take the simpler model (<code>m2</code>)</p>
<p><strong>Exercise:</strong> Generate all possible models and select the model with minimum AIC.</p>
</section>
<section id="automatic-model-selection" class="slide level2">
<h2>Automatic Model Selection</h2>
<ul>
<li>The full model is supplied to the <code>step</code> function.</li>
<li>The model with the smallest AIC ist the optimal model:</li>
</ul>
<div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> diet <span class="sc">*</span> coat, <span class="at">data=</span>hams)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>opt <span class="ot">&lt;-</span> <span class="fu">step</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-8.52
growth ~ diet * coat

            Df Sum of Sq    RSS     AIC
- diet:coat  2   0.68667 2.8567 -9.2230
&lt;none&gt;                   2.1700 -8.5222

Step:  AIC=-9.22
growth ~ diet + coat

       Df Sum of Sq    RSS     AIC
&lt;none&gt;              2.8567 -9.2230
- diet  2    2.6600 5.5167 -5.3256
- coat  1    2.6133 5.4700 -3.4275</code></pre>
</div>
</div>
</div>
<div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(opt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = growth ~ diet + coat, data = hams)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.6333 -0.3458 -0.1000  0.2333  0.8667 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   8.1667     0.3450  23.671 1.08e-08 ***
dietB         0.2500     0.4225   0.592   0.5704    
dietC         1.1000     0.4225   2.603   0.0315 *  
coatlight    -0.9333     0.3450  -2.705   0.0269 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5976 on 8 degrees of freedom
Multiple R-squared:  0.6486,    Adjusted R-squared:  0.5169 
F-statistic: 4.923 on 3 and 8 DF,  p-value: 0.03178</code></pre>
</div>
</div>
</div>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li>Linear models form the basis of many statistical methods
<ul>
<li>Linear regression</li>
<li>ANOVA, ANCOVA, GLM, GAM, GLMM, . . .</li>
<li>ANOVA/ANCOVA instead of multiple testing</li>
</ul></li>
<li>ANOVA is more powerful than multiple tests:
<ul>
<li>one big experiment needs less n than many small experiments together</li>
<li>identification of interaction effects</li>
<li>elimination of co-variates</li>
</ul></li>
<li>Model selection vs.&nbsp;p-value based testing
<ul>
<li>paradigm shift in statistics: AIC instead of p-value</li>
<li>more reliable, especially for imbalanced or complex designs</li>
<li>but: p-value based tests are sometimes easier to understand</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="avoid-p-value-hacking" class="title-slide slide level1 center">
<h1>Avoid p-value hacking</h1>
<p><strong>Do NOT repeat experiments until a significant p-value is found.</strong></p>
<p>“As debate rumbles on about how and how much poor statistics is to blame for poor reproducibility, Nature asked influential statisticians to recommend one change to improve science. The common theme? The problem is not our maths, but ourselves.” Leek et al.&nbsp;(2017)</p>
</section>
<section id="five-ways-to-fix-statistics.-comment-on-nature" class="slide level2">
<h2>Five ways to fix statistics. Comment on Nature</h2>
<p><br></p>
<p>Leek et al.&nbsp;(2017) <a href="https://doi.org/10.1038/d41586-017-07522-z">https://doi.org/10.1038/d41586-017-07522-z</a></p>
<ol type="1">
<li>Jeff Leek: Adjust for human cognition</li>
<li>Blakeley B. McShane &amp; Andrew Gelman: Abandon statistical significance</li>
<li>David Colquhoun: State false-positive risk, too</li>
<li>Michèle B. Nuijten: Share analysis plans and results</li>
<li>Steven N. Goodman: Change norms from within</li>
</ol>
<p>Another blog post that aims to improve understanding: http://daniellakens.blogspot.de/2017/12/understanding-common-misconceptions.html?m=1</p>
<hr>

<p><strong>My conclusion:</strong> The p-value is still useful but apply it with great care.</p>
</section>
<section id="bibliography" class="slide level2 smaller scrollable">
<h2>Bibliography</h2>

<div class="footer footer-default">

</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography">
<div id="ref-Crawley2002" class="csl-entry" role="doc-biblioentry">
Crawley, M. J. (2002). <em>Statistical computing. An introduction to data analysis using <span>S-PLUS</span></em> (pp. 1–761). Wiley. <a href="datasets: http://www.bio.ic.ac.uk/research/mjcraw/statcomp/data/">datasets: http://www.bio.ic.ac.uk/research/mjcraw/statcomp/data/</a>
</div>
<div id="ref-Dobson2013" class="csl-entry" role="doc-biblioentry">
Dobson, A. J. (2013). <em>Introduction to statistical modelling</em>. Springer.
</div>
<div id="ref-Dziallas2011" class="csl-entry" role="doc-biblioentry">
Dziallas, C., &amp; Grossart, H.-P. (2011). Increasing <span>Oxygen Radicals</span> and <span>Water Temperature Select</span> for <span>Toxic Microcystis</span> sp. <em>PLoS ONE</em>, <em>6</em>(9), e25569. <a href="https://doi.org/10.1371/journal.pone.0025569">https://doi.org/10.1371/journal.pone.0025569</a>
</div>
<div id="ref-Holm1979" class="csl-entry" role="doc-biblioentry">
Holm, S. (1979). A simple sequentially rejective multiple test procedure. <em>Scandinavian Journal of Statistics</em>, 65–70. <a href="https://www.jstor.org/stable/4615733">https://www.jstor.org/stable/4615733</a>
</div>
<div id="ref-Jahnichen2007" class="csl-entry" role="doc-biblioentry">
Jähnichen, S., Ihle, T., Petzoldt, T., &amp; Benndorf, J. (2007). Impact of <span>Inorganic Carbon Availability</span> on <span>Microcystin Production</span> by <span>Microcystis</span> aeruginosa <span>PCC</span> 7806. <em>Applied and Environmental Microbiology</em>, <em>73</em>(21), 6994–7002. <a href="https://doi.org/10.1128/AEM.01253-07">https://doi.org/10.1128/AEM.01253-07</a>
</div>
<div id="ref-Jahnichen2011" class="csl-entry" role="doc-biblioentry">
Jähnichen, S., Long, B. M., &amp; Petzoldt, T. (2011). Microcystin production by <span>Microcystis</span> aeruginosa: <span>Direct</span> regulation by multiple environmental factors. <em>Harmful Algae</em>, <em>12</em>, 95–104. <a href="https://doi.org/10.1016/j.hal.2011.09.002">https://doi.org/10.1016/j.hal.2011.09.002</a>
</div>
<div id="ref-Jahnichen2001" class="csl-entry" role="doc-biblioentry">
Jähnichen, S., Petzoldt, T., &amp; Benndorf, J. (2001). Evidence for control of microcystin dynamics in <span>Bautzen Reservoir</span> (<span>Germany</span>) by cyanobacterial population growth rates and dissolved inorganic carbon. <em>Fundamental and Applied Limnology</em>, <em>150</em>(2), 177–196. <a href="https://doi.org/10.1127/archiv-hydrobiol/150/2001/177">https://doi.org/10.1127/archiv-hydrobiol/150/2001/177</a>
</div>
<div id="ref-JohnsonOmland2004" class="csl-entry" role="doc-biblioentry">
Johnson, G., Jerald, &amp; Omland, K. S. (2004). Model <span>Selection</span> in <span>Ecology</span> and <span>Evolution</span>. <em>Trends in Ecology and Evolution</em>, <em>19</em>(2), 101–108. <a href="https://doi.org/10.1016/j.tree.2003.10.013">https://doi.org/10.1016/j.tree.2003.10.013</a>
</div>
<div id="ref-Zilliges2011" class="csl-entry" role="doc-biblioentry">
Zilliges, Y., Kehr, J.-C., Meissner, S., Ishida, K., Mikkat, S., Hagemann, M., Kaplan, A., Börner, T., &amp; Dittmann, E. (2011). The <span>Cyanobacterial Hepatotoxin Microcystin Binds</span> to <span>Proteins</span> and <span>Increases</span> the <span>Fitness</span> of <span>Microcystis</span> under <span>Oxidative Stress Conditions</span>. <em>PLoS ONE</em>, <em>6</em>(3), e17615. <a href="https://doi.org/10.1371/journal.pone.0017615">https://doi.org/10.1371/journal.pone.0017615</a>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>