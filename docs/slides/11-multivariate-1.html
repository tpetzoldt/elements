<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.554">

  <meta name="author" content="Thomas Petzoldt">
  <meta name="dcterms.date" content="2024-10-30">
  <title>Elements of Data Analysis and Statistics - 11-Multivariate methods I</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="../thpe.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

  <script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

  <script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

  <link href="../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">

  <script src="../site_libs/leaflet-1.3.1/leaflet.js"></script>

  <link href="../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">

  <script src="../site_libs/proj4-2.6.2/proj4.min.js"></script>

  <script src="../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>

  <link href="../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">

  <script src="../site_libs/leaflet-binding-2.2.2/leaflet.js"></script>

  <script src="../site_libs/rglWebGL-binding-1.3.1/rglWebGL.js"></script>

  <link href="../site_libs/rglwidgetClass-1.3.1/rgl.css" rel="stylesheet">

  <script src="../site_libs/rglwidgetClass-1.3.1/rglClass.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/utils.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/buffer.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/subscenes.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/shaders.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/shadersrc.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/textures.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/projection.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/mouse.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/init.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/pieces.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/draw.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/controls.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/selection.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/rglTimer.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/pretty.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/axes.src.js"></script>

  <script src="../site_libs/rglwidgetClass-1.3.1/animation.src.js"></script>

  <script src="../site_libs/CanvasMatrix4-1.3.1/CanvasMatrix.src.js"></script>

  <style>
  #title-slide 
    .title {color: #ee7f00;}
    .subtitle {color: #ee7f00;}
    .quarto-title-author {color: #69af22;}
    .date {color: #69af22;}
  </style>  
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" body-color="#069af22" data-background-image="../img/tud-title-bg-wide-2021.png" class="quarto-title-block center">
  <h1 class="title">11-Multivariate methods I</h1>
  <p class="subtitle">Applied Statistics – A Practical Course</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Thomas Petzoldt 
</div>
</div>
</div>

  <p class="date">2024-10-30</p>
</section>
<section id="data-sets-and-terms-of-use" class="slide level2">
<h2>Data sets and terms of use</h2>
<p><br></p>
<ol type="1">
<li><p>The “UBA-lakes” data set originates from the public data repository of the German Umweltbundesamt <span class="citation" data-cites="UBA2020">(<a href="#/references" role="doc-biblioref" onclick="">Umweltbundesamt, 2021</a>)</span>. The data set provided can be used freely according to the <a href="https://www.umweltbundesamt.de/datenschutz-haftung#c-urheber-und-kennzeichenrecht">terms and conditions</a> published at the <a href="https://www.umweltbundesamt.de/">UBA web site</a>, that refer to § 12a EGovG with respect of the data, and to the <a href="https://creativecommons.org/licenses/by-nd/4.0/deed.de">Creative Commons CC-BY ND International License 4.0</a> with respect to other objects directly created by UBA.</p></li>
<li><p>The “gauernitz” data set contains simplified teaching versions from research data, of the study from <span class="citation" data-cites="winkelmann_fish_2011">Winkelmann et al. (<a href="#/references" role="doc-biblioref" onclick="">2011</a>)</span></p></li>
<li><p>The document itself, the codes and the ebedded images are own work and can be shared according to <a href="https://creativecommons.org/licenses/by/4.0/deed.en">CC BY 4.0</a>.</p></li>
</ol>
</section>
<section id="an-introductory-example" class="slide level2">
<h2>An introductory example</h2>

<img data-src="../img/uba-lakes.png" class="r-stretch"></section>
<section id="correlation-between-all-variables" class="slide level2">
<h2>Correlation between all variables?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"readxl"</span>) <span class="co"># read Excel files directly</span></span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a>lakes <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(<span class="st">"../data/uba/3_tab_kenndaten-ausgew-seen-d_2021-04-08.xlsx"</span>, <span class="at">sheet=</span><span class="st">"Tabelle1"</span>, <span class="at">skip=</span><span class="dv">3</span>)</span>
<span id="cb1-4"><a aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lakes) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"state"</span>, <span class="st">"drainage"</span>, <span class="st">"population"</span>, <span class="st">"altitude"</span>, </span>
<span id="cb1-6"><a aria-hidden="true" tabindex="-1"></a>                  <span class="st">"z_mean"</span>, <span class="st">"z_max"</span>, <span class="st">"t_ret"</span>, <span class="st">"volume"</span>, <span class="st">"area"</span>, <span class="st">"shore_length"</span>, </span>
<span id="cb1-7"><a aria-hidden="true" tabindex="-1"></a>                  <span class="st">"shore_devel"</span>, <span class="st">"drain_ratio"</span>, <span class="st">"wfd_type"</span>)</span>
<span id="cb1-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(lakes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   56 obs. of  14 variables:
 $ name        : chr  "Ammersee" "Arendsee" "Bleilochtalsperre" "Bodensee" ...
 $ state       : chr  "BY" "ST" "TH" "BW" ...
 $ drainage    : num  993 29.8 1239.9 11477 28.2 ...
 $ population  : num  114900 3200 180000 1400000 28 ...
 $ altitude    : num  532.9 22.8 404 395.4 13.1 ...
 $ z_mean      : num  37.6 28.6 23.3 85 2.4 ...
 $ z_max       : num  81.1 48.7 55 254 4.8 58.3 32.5 73.4 1.7 18.8 ...
 $ t_ret       : num  2.7 50 0.526 4.2 1.9 16.3 NA 1.26 0.1 2.3 ...
 $ volume      : num  1.75 0.147 0.215 48.522 0.009 ...
 $ area        : num  46.6 5.14 9.2 571.5 3.9 ...
 $ shore_length: num  43 9 NA 273 10.4 13.7 17.5 64 7.5 10.1 ...
 $ shore_devel : num  1.78 1.12 NA 2.26 1.48 2.09 1.64 2.02 2.22 1.6 ...
 $ drain_ratio : num  20.3 5.8 NA 21.9 7.2 ...
 $ wfd_type    : chr  "Typ 4" "Typ 13" "Typ 5" "Typ 4" ...</code></pre>
</div>
</div>
<ul>
<li><code>names(lakes)</code> replaces the original German column names by abbreviated English abbreviations</li>
</ul>
</section>
<section id="create-pairwise-scatter-plots-for-all-variables" class="slide level2">
<h2>Create pairwise scatter plots for all variables?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lakes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="11-multivariate-1_files/figure-revealjs/lakes-all-variables-1.png" width="960" class="r-stretch"></section>
<section id="create-pairwise-scatter-plots-for-all-variables-1" class="slide level2">
<h2>Create pairwise scatter plots for all variables?</h2>
<p><br></p>
<ul>
<li><p>not a good idea, 14 variables would produce 182 (or 91) plots</p></li>
<li><p>can lead to “statistical fishing”</p></li>
<li><p>we need methods to extract the main information with a small number of plots</p></li>
</ul>
</section>
<section id="the-multivariate-approach" class="slide level2">
<h2>The multivariate approach</h2>
<p><br></p>
<p><span class="bigfont">Work with the complete original variables directly</span></p>
<p><br></p>
<p><strong><span class="math inline">\(\rightarrow\)</span> Multivariate statistics</strong></p>
<ul>
<li>dependent variables <span class="gray">+ explanation variables optional</span></li>
<li>analyze distance and location in multidimensional space</li>
<li>find way to vizualize relationship in lower dimensions</li>
</ul>
<p><br></p>
<p>For comparison</p>
<ul>
<li>univariate: 1 variable</li>
<li>bivariate: 1 dependent, 1 independent variable</li>
<li>multiple: 1 dependent, &gt;1 independent variables</li>
</ul>
</section>
<section id="two-approches-of-multivariate-statistics" class="slide level2">
<h2>Two approches of multivariate statistics</h2>
<div class="column add-space" style="width:46%;">
<p><strong>Ordination</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="11-multivariate-1_files/figure-revealjs/approach-pca-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>dimension reduction</li>
<li>relate observations and variables</li>
</ul>
</div>
<div class="column" style="width:46%;">
<p><strong>Cluster analysis</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="11-multivariate-1_files/figure-revealjs/approach-cluster-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>distance and similarity</li>
<li>identification of groups</li>
</ul>
</div>
</section>
<section id="basic-concepts" class="slide level2">
<h2>Basic concepts</h2>
<p><br></p>
<p><strong>Similarity and correlation</strong></p>
<ul>
<li>distance and similarity:<br> <span class="math inline">\(\rightarrow\)</span> How different or similar are the observations?</li>
<li>correlation and covariance:<br> <span class="math inline">\(\rightarrow\)</span> Are variables interdependent?</li>
<li>dimension reduction:<br> <span class="math inline">\(\rightarrow\)</span> Try to show essential parts of information on a lower number of dimensions.</li>
<li>cluster analysis:<br> <span class="math inline">\(\rightarrow\)</span> Show which observations are closely together.</li>
<li>ordination:<br> <span class="math inline">\(\rightarrow\)</span> Plot data at lower dimensions, similar observations closely together.</li>
</ul>
</section>
<section>
<section id="the-uba-lakes-example" class="title-slide slide level1 center">
<h1>The UBA-lakes example</h1>

</section>
<section id="a-data-set-from-german-lakes" class="slide level2">
<h2>A data set from German lakes</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-109e34353c94f97be311" style="width:960px;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-109e34353c94f97be311">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"zoomControl":true},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[48,52.889167,47.633333,47.861944,54.318685,52.433333,54.130278,53.808333,50.410278,53.416667,53.50944,53.465833,52.440278,52.25,53.72779,53.64618,47.916667,53.151553,52.472222,51.194722],[11.116667,11.474167,9.366667,12.401111,10.306038,13.65,10.414167,12.859444,7.269722,12.683333,12.66522,12.3075,13.097222,14.05,11.46456,11.45891,11.316667,13.026172,9.33,6.891667],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":["Ammersee","Arendsee","Bodensee","Chiemsee","Dobersdorfer See","Großer Müggelsee","Großer Plöner See","Kummerower See","Laacher See","Müritz (Außenmüritz)","Müritz (Binnenmüritz)","Plauer See","Sacrower See","Scharmützelsee","Schweriner See (Außensee)","Schweriner See (Innensee)","Starnberger See","Stechlinsee","Steinhuder Meer","Unterbacher See"],"alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250,"closeButton":false},["Ammersee","Arendsee","Bodensee","Chiemsee","Dobersdorfer See","Großer Müggelsee","Großer Plöner See","Kummerower See","Laacher See","Müritz (Außenmüritz)","Müritz (Binnenmüritz)","Plauer See","Sacrower See","Scharmützelsee","Schweriner See (Außensee)","Schweriner See (Innensee)","Starnberger See","Stechlinsee","Steinhuder Meer","Unterbacher See"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"setView":[[51.16,10.447],5,[]],"limits":{"lat":[47.633333,54.318685],"lng":[6.891667,14.05]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><small> GPS data from <a href="https://de.wikipedia.org">Wikipedia</a> and <a href="https://maps.google.de">Google Maps</a>, map from <a href="https://www.openstreetmap.org/copyright/">https://www.openstreetmap.org/</a> </small></p>
</section>
<section id="example-a-simplified-subset-from-the-uba-lake-data" class="slide level2">
<h2>Example: A simplified subset from the UBA lake data</h2>
<p><small></small></p><small>
<div class="cell">
<div class="cell-output-display">
<table>
<colgroup>
<col style="width: 7%">
<col style="width: 24%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">shortname</th>
<th style="text-align: right;">z_mean</th>
<th style="text-align: right;">z_max</th>
<th style="text-align: right;">t_ret</th>
<th style="text-align: right;">volume</th>
<th style="text-align: right;">area</th>
<th style="text-align: right;">p_tot</th>
<th style="text-align: right;">n_no3</th>
<th style="text-align: right;">chl</th>
<th style="text-align: left;">wfd_type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ammer</td>
<td style="text-align: left;">Ammersee</td>
<td style="text-align: left;">Ammer</td>
<td style="text-align: right;">37.60</td>
<td style="text-align: right;">81.1</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">1.75000</td>
<td style="text-align: right;">46.600</td>
<td style="text-align: right;">7.3</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: left;">Typ 4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arend</td>
<td style="text-align: left;">Arendsee</td>
<td style="text-align: left;">Arend</td>
<td style="text-align: right;">28.60</td>
<td style="text-align: right;">48.7</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: right;">0.14700</td>
<td style="text-align: right;">5.140</td>
<td style="text-align: right;">375.0</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">22.30</td>
<td style="text-align: left;">Typ 13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Boden</td>
<td style="text-align: left;">Bodensee</td>
<td style="text-align: left;">Boden</td>
<td style="text-align: right;">85.00</td>
<td style="text-align: right;">254.0</td>
<td style="text-align: right;">4.20</td>
<td style="text-align: right;">48.52150</td>
<td style="text-align: right;">571.500</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">2.10</td>
<td style="text-align: left;">Typ 4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chiem</td>
<td style="text-align: left;">Chiemsee</td>
<td style="text-align: left;">Chiem</td>
<td style="text-align: right;">25.60</td>
<td style="text-align: right;">73.4</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">2.04800</td>
<td style="text-align: right;">79.900</td>
<td style="text-align: right;">9.2</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">3.80</td>
<td style="text-align: left;">Typ 4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dober</td>
<td style="text-align: left;">Dobersdorfer See</td>
<td style="text-align: left;">Dober</td>
<td style="text-align: right;">5.40</td>
<td style="text-align: right;">18.8</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">0.01690</td>
<td style="text-align: right;">3.120</td>
<td style="text-align: right;">63.9</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">27.30</td>
<td style="text-align: left;">Typ 14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Muegg</td>
<td style="text-align: left;">Großer Müggelsee</td>
<td style="text-align: left;">Muegg</td>
<td style="text-align: right;">4.85</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.03500</td>
<td style="text-align: right;">7.200</td>
<td style="text-align: right;">189.9</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">32.90</td>
<td style="text-align: left;">Typ 11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ploen</td>
<td style="text-align: left;">Großer Plöner See</td>
<td style="text-align: left;">Ploen</td>
<td style="text-align: right;">12.40</td>
<td style="text-align: right;">58.0</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">0.37200</td>
<td style="text-align: right;">29.970</td>
<td style="text-align: right;">62.3</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">8.80</td>
<td style="text-align: left;">Typ 13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kumme</td>
<td style="text-align: left;">Kummerower See</td>
<td style="text-align: left;">Kumme</td>
<td style="text-align: right;">8.10</td>
<td style="text-align: right;">23.3</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">0.26300</td>
<td style="text-align: right;">32.500</td>
<td style="text-align: right;">65.3</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">16.60</td>
<td style="text-align: left;">Typ 11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mueritz</td>
<td style="text-align: left;">Müritz (Außenmüritz)</td>
<td style="text-align: left;">Mueritz</td>
<td style="text-align: right;">6.50</td>
<td style="text-align: right;">28.1</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">0.68000</td>
<td style="text-align: right;">105.300</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">6.30</td>
<td style="text-align: left;">Typ 14</td>
</tr>
<tr class="even">
<td style="text-align: left;">MuerB</td>
<td style="text-align: left;">Müritz (Binnenmüritz)</td>
<td style="text-align: left;">MuerB</td>
<td style="text-align: right;">9.80</td>
<td style="text-align: right;">30.3</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">0.03800</td>
<td style="text-align: right;">3.910</td>
<td style="text-align: right;">34.2</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">6.70</td>
<td style="text-align: left;">Typ 10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plaue</td>
<td style="text-align: left;">Plauer See</td>
<td style="text-align: left;">Plaue</td>
<td style="text-align: right;">6.80</td>
<td style="text-align: right;">25.5</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">0.30000</td>
<td style="text-align: right;">38.400</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">6.80</td>
<td style="text-align: left;">Typ 10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sacro</td>
<td style="text-align: left;">Sacrower See</td>
<td style="text-align: left;">Sacro</td>
<td style="text-align: right;">18.01</td>
<td style="text-align: right;">36.0</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">0.01930</td>
<td style="text-align: right;">1.072</td>
<td style="text-align: right;">79.8</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">8.60</td>
<td style="text-align: left;">Typ 10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Schar</td>
<td style="text-align: left;">Scharmützelsee</td>
<td style="text-align: left;">Schar</td>
<td style="text-align: right;">9.00</td>
<td style="text-align: right;">29.5</td>
<td style="text-align: right;">16.00</td>
<td style="text-align: right;">0.10823</td>
<td style="text-align: right;">12.090</td>
<td style="text-align: right;">35.3</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">10.40</td>
<td style="text-align: left;">Typ 13</td>
</tr>
<tr class="even">
<td style="text-align: left;">SchwA</td>
<td style="text-align: left;">Schweriner See (Außensee)</td>
<td style="text-align: left;">SchwA</td>
<td style="text-align: right;">9.40</td>
<td style="text-align: right;">52.4</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">0.33100</td>
<td style="text-align: right;">35.200</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">11.70</td>
<td style="text-align: left;">Typ 13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SchwI</td>
<td style="text-align: left;">Schweriner See (Innensee)</td>
<td style="text-align: left;">SchwI</td>
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">44.6</td>
<td style="text-align: right;">5.30</td>
<td style="text-align: right;">0.35600</td>
<td style="text-align: right;">26.400</td>
<td style="text-align: right;">246.5</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">5.86</td>
<td style="text-align: left;">Typ 13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Starn</td>
<td style="text-align: left;">Starnberger See</td>
<td style="text-align: left;">Starn</td>
<td style="text-align: right;">53.20</td>
<td style="text-align: right;">127.8</td>
<td style="text-align: right;">21.00</td>
<td style="text-align: right;">2.99900</td>
<td style="text-align: right;">56.400</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: left;">Typ 3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stech</td>
<td style="text-align: left;">Stechlinsee</td>
<td style="text-align: left;">Stech</td>
<td style="text-align: right;">22.80</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">32.00</td>
<td style="text-align: right;">0.09700</td>
<td style="text-align: right;">4.250</td>
<td style="text-align: right;">15.8</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: left;">Typ 13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stein</td>
<td style="text-align: left;">Steinhuder Meer</td>
<td style="text-align: left;">Stein</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">0.04200</td>
<td style="text-align: right;">29.100</td>
<td style="text-align: right;">53.3</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">29.00</td>
<td style="text-align: left;">Typ 11</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>mean and maximum depth (<span class="math inline">\(\mathrm{m}\)</span>): z_mean, z_max; retention time (years): t_ret; volume (<span class="math inline">\(\mathrm{10^9 m^3}\)</span>); area (<span class="math inline">\(\mathrm{km^2}\)</span>), total phosphorus P (<span class="math inline">\(\mathrm{\mu g/L}\)</span>): p_tot; nitrogen-N (<span class="math inline">\(\mathrm{mg/L}\)</span>): n_no3, chlorophyll (<span class="math inline">\(\mathrm{\mu g/L}\)</span>): chl, water framework directive lake type: wfd_type</p>
<p><br></p>
<p>Data set from UBA (Umweltbundesamt = German Federal Environmental Agency), data modified<br> Original data source: <a href="https://www.umweltbundesamt.de/themen/wasser/seen">https://www.umweltbundesamt.de/themen/wasser/seen</a><br> Terms of use: <a href="https://www.umweltbundesamt.de/datenschutz-haftung-urheberrecht">https://www.umweltbundesamt.de/datenschutz-haftung-urheberrecht</a></p>
</small><p><small></small></p>
</section>
<section id="code-to-read-the-data" class="slide level2">
<h2>Code to read the data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" tabindex="-1"></a>lakes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/tpetzoldt/elements/main/data/uba/lakes-combined-data.csv"</span>)</span>
<span id="cb4-2"><a aria-hidden="true" tabindex="-1"></a>valid_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"shortname"</span>, <span class="st">"z_mean"</span>, <span class="st">"z_max"</span>,  <span class="st">"t_ret"</span>, <span class="st">"volume"</span>, </span>
<span id="cb4-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="st">"area"</span>, <span class="st">"p_tot"</span>, <span class="st">"n_no3"</span>, <span class="st">"chl"</span>, <span class="st">"wfd_type"</span>)</span>
<span id="cb4-4"><a aria-hidden="true" tabindex="-1"></a>lakes <span class="ot">&lt;-</span> lakes[valid_columns] <span class="sc">|&gt;</span> <span class="fu">na.omit</span>()</span>
<span id="cb4-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(lakes) <span class="ot">&lt;-</span> lakes<span class="sc">$</span>shortname</span>
<span id="cb4-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a aria-hidden="true" tabindex="-1"></a>lake_ids <span class="ot">&lt;-</span> lakes[<span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"shortname"</span>)]</span>
<span id="cb4-8"><a aria-hidden="true" tabindex="-1"></a>lakedata <span class="ot">&lt;-</span> lakes[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb4-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a aria-hidden="true" tabindex="-1"></a><span class="do">## remove wfd_type for now</span></span>
<span id="cb4-11"><a aria-hidden="true" tabindex="-1"></a>lakedata<span class="sc">$</span>wfd_type <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<ul>
<li>Source of original data: Uwweltbundesamt <a href="https://www.uba.de">https://www.uba.de</a></li>
<li>Data files downloadable from <a href="https://github.com/tpetzoldt/elements/tree/main/data/uba">https://github.com/tpetzoldt/elements/tree/main/data/uba</a></li>
<li>Terms of use, see: <a href="https://github.com/tpetzoldt/elements/blob/main/data/uba/3_tab_kenndaten-ausgew-seen-d_2021-04-08-copyright.txt">Copyright</a> and <a href="https://github.com/tpetzoldt/elements/blob/main/data/uba/lakes-combined-data-info.txt">description of derived data</a></li>
</ul>
</section>
<section id="data-transformation-and-normalization" class="slide level2">
<h2>Data transformation and normalization</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">1</span>), <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(lakedata, <span class="at">main =</span> <span class="st">"raw data"</span>)</span>
<span id="cb5-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">scale</span>(lakedata), <span class="at">main =</span> <span class="st">"normalized"</span>)</span>
<span id="cb5-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">scale</span>(<span class="fu">sqrt</span>(lakedata)), <span class="at">main =</span> <span class="st">"sqrt + normalized"</span>)</span>
<span id="cb5-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">scale</span>(<span class="fu">log</span>(lakedata)), <span class="at">main =</span> <span class="st">"log + normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="11-multivariate-1_files/figure-revealjs/uba-lakes-boxplot-1.png" class="quarto-figure quarto-figure-center r-stretch" width="768"><ul>
<li><code>scale()</code> performs normalisation (z-transformation)</li>
<li>aim: make different scales better comparable</li>
</ul>
</section></section>
<section>
<section id="ordination-methods" class="title-slide slide level1 center">
<h1>Ordination methods</h1>

</section>
<section id="principal-component-analysis-pca" class="slide level2">
<h2>Principal Component Analysis: PCA</h2>
<p><br></p>
<ul>
<li>identify cvovariance or correlation structure</li>
<li>rotate coordinate system, so that it points in the diretions of maximum variance</li>
<li><span class="math inline">\(k\)</span> dimensions in original space are transformed into <span class="math inline">\(k\)</span> orthogonal (rectangular) coordinates in principal components space.</li>
<li>works with any number of dimensions</li>
<li>visualisation by a 3D example</li>
</ul>
</section>
<section id="correlation-structure-of-the-lakes-data-set" class="slide level2">
<h2>Correlation structure of the lakes data set</h2>
<p><br></p>
<div class="bigfont">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(lakedata), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       z_mean z_max t_ret volume  area p_tot n_no3   chl
z_mean   1.00  0.97  0.20   0.81  0.78 -0.17  0.48 -0.49
z_max    0.97  1.00  0.07   0.88  0.87 -0.26  0.47 -0.54
t_ret    0.20  0.07  1.00  -0.12 -0.18  0.48 -0.41 -0.04
volume   0.81  0.88 -0.12   1.00  0.98 -0.20  0.44 -0.27
area     0.78  0.87 -0.18   0.98  1.00 -0.26  0.45 -0.32
p_tot   -0.17 -0.26  0.48  -0.20 -0.26  1.00 -0.32  0.47
n_no3    0.48  0.47 -0.41   0.44  0.45 -0.32  1.00 -0.15
chl     -0.49 -0.54 -0.04  -0.27 -0.32  0.47 -0.15  1.00</code></pre>
</div>
</div>
</div>
<p><br></p>
<ul>
<li>Let’s pick 3 variables for a 3D visualization: <code>z_mix</code>, <code>z_max</code> and <code>volume</code>.</li>
<li>Use log-transformation to make them symetrically distributed.</li>
</ul>
</section>
<section id="z_mix-z_max-and-volume-are-highly-corelated" class="slide level2">
<h2><code>z_mix</code>, <code>z_max</code> and <code>volume</code> are highly corelated</h2>

<img data-src="11-multivariate-1_files/figure-revealjs/scatterplot-3-variables-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p><span class="math inline">\(\rightarrow\)</span> We see that the three variables carry <strong>redundant</strong> information.</p>
</section>
<section id="how-rotation-of-axes-works" class="slide level2">
<h2>How rotation of axes works</h2>
<div class="column" style="width:48%;">
<p>Original coordinates</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display no-overflow-x">
<style>#rgl97245 {margin:auto;}</style>
<div id="rgl97245" style="width:384px;height:384px;" class="rglWebGL html-widget" role="img" aria-labelledby="rgl97245-aria"></div>
<script type="application/json" data-for="rgl97245">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":85,"objects":{"91":{"id":91,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.1089512258768082]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"92":{"id":92,"type":"lines","material":{"lit":false},"vertices":"3","colors":"4","centers":"5","ignoreExtent":false,"flags":32832},"93":{"id":93,"type":"lines","material":{"lit":false},"vertices":"6","colors":"7","centers":"8","ignoreExtent":false,"flags":32832},"94":{"id":94,"type":"lines","material":{"lit":false},"vertices":"9","colors":"10","centers":"11","ignoreExtent":false,"flags":32832},"95":{"id":95,"type":"text","material":{"lit":false},"vertices":"12","colors":"13","texts":[["log_z_mean"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"14","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"96":{"id":96,"type":"text","material":{"lit":false},"vertices":"15","colors":"16","texts":[["log_z_max"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"17","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"97":{"id":97,"type":"text","material":{"lit":false},"vertices":"18","colors":"19","texts":[["log_volume"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"20","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"89":{"id":89,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"88":{"id":88,"type":"background","material":{},"colors":"21","centers":"22","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"90":{"id":90,"type":"background","material":{"lit":false,"back":"lines"},"colors":"23","centers":"24","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"85":{"id":85,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":85,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,27.57394790649414],"modelMatrix":[[0.9961947202682495,0,-0.08715573698282242,-2.126302719116211],[-0.02255756407976151,0.9659258127212524,-0.2578341662883759,-3.264079809188843],[0.08418597280979156,0.258819043636322,0.9622501730918884,-27.15927505493164],[0,0,0,1]],"projMatrix":[[3.732050895690918,0,0,0],[0,3.732050895690918,0,0],[0,0,-3.863703489303589,-99.40089416503906],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[0.9961947202682495,0,-0.08715573698282242,0],[-0.02255756407976151,0.9659258127212524,-0.2578341662883759,0],[0.08418597280979156,0.258819043636322,0.9622501730918884,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-1.02524197101593,5.044586181640625,0,6.091067790985107,-7.122066974639893,4.27020788192749],"windowRect":[34,57,290,313],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[90,91,92,93,94,95,96,97,89],"subscenes":[],"flags":34131}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":384,"height":384,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":54,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":54,"type":"VEC4","normalized":true},{"bufferView":2,"componentType":5126,"count":54,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":14,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":15,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":17,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":18,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":19,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":20,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":21,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":22,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":23,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":24,"componentType":5121,"count":1,"type":"VEC3"}],"bufferViews":[{"buffer":0,"byteLength":648,"byteOffset":0},{"buffer":0,"byteLength":216,"byteOffset":648},{"buffer":0,"byteLength":648,"byteOffset":864},{"buffer":0,"byteLength":24,"byteOffset":1512},{"buffer":0,"byteLength":4,"byteOffset":1536},{"buffer":0,"byteLength":12,"byteOffset":1540},{"buffer":0,"byteLength":24,"byteOffset":1552},{"buffer":0,"byteLength":4,"byteOffset":1576},{"buffer":0,"byteLength":12,"byteOffset":1580},{"buffer":0,"byteLength":24,"byteOffset":1592},{"buffer":0,"byteLength":4,"byteOffset":1616},{"buffer":0,"byteLength":12,"byteOffset":1620},{"buffer":0,"byteLength":12,"byteOffset":1632},{"buffer":0,"byteLength":4,"byteOffset":1644},{"buffer":0,"byteLength":12,"byteOffset":1648},{"buffer":0,"byteLength":12,"byteOffset":1660},{"buffer":0,"byteLength":4,"byteOffset":1672},{"buffer":0,"byteLength":12,"byteOffset":1676},{"buffer":0,"byteLength":12,"byteOffset":1688},{"buffer":0,"byteLength":4,"byteOffset":1700},{"buffer":0,"byteLength":12,"byteOffset":1704},{"buffer":0,"byteLength":16,"byteOffset":1716},{"buffer":0,"byteLength":3,"byteOffset":1732},{"buffer":0,"byteLength":4,"byteOffset":1735},{"buffer":0,"byteLength":3,"byteOffset":1739}],"buffers":[{"byteLength":1742,"bytes":"1iBoQG+pjED7Qg8/N55WQPeueEDUavW/Q4BJQBM8gEBCwMS/MyqOQNgxsUDNcnhAuB5gP2jI\nyD+rvJbAjLFGQGoZgkDBFyTAEQExQKPMXkA8hve/ooZPQDV4iUBhhDc/AAAAAEHXBz9ya+DA\n7NvXP1DEO0D6koLAg2oRQD1kXED7/izAl1gqQJ7OXUCQffK/VY4yQJjAekAGWcW/+RvKPyz0\nAEDXjVbA8CEhQCbvgUAGJn2/ZcBNQJWUhUBvFNq/k9tbQDsFhkDjMdi/acCSQLQspkCxeiu/\nLPQAQHPxVUDsDjTAw3YDQKTTRUCWXnrAGuEFQEOASUD79Kq/N/tbQAije0BDeRHAOpwNQJad\nZ0AmYpbAHCojQD0rVkAMLSTAN5fvP0B9VUCNdcW+jhISQD5QWkBzSlHAgIvxP18LMUBWWb7A\nI1I6QEMZfkBNpnzAm38eQI4IWUAsmYjAuF31P4JGT0DIG5q/CJJqv5vvPT9VDN3ArItNQLUr\njUA5RxzAak8cQA10TED7lvC/8wQ5QGBYZUBNpnzACcc9QGjIhEBZBgjAVJ8MQNqZWEDFTQ7A\nf6wyQFygc0D0KnjAhQ4ZQDdiWEDpkJjAymcPQLpefUCDhY2/eJImQBIOc0CYM4S/A8snQBn9\nZEDIsZy/iP1BQK1ggUCjLCrAFfERQPsea0As4SXA+VZ+QAY3m0BnlIw/2BxIQDUGh0CZUBXA\nT6eZPnFIiD+v4krAItMHQEQ8TUCOOo/AWOBlQG8eiUAWnpC/fOg3QD1kXEDIG5q/D2zLP6cY\nJkCS0a/AE4uMQAnSp0BcNoY+j3YSQKROQUAHyhTADdkrQOSvYUCETDDACJJqP2jIyD+ok6TA\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n1iBoQG+pjED7Qg8/N55WQPeueEDUavW/Q4BJQBM8gEBCwMS/MyqOQNgxsUDNcnhAuB5gP2jI\nyD+rvJbAjLFGQGoZgkDBFyTAEQExQKPMXkA8hve/ooZPQDV4iUBhhDc/AAAAAEHXBz9ya+DA\n7NvXP1DEO0D6koLAg2oRQD1kXED7/izAl1gqQJ7OXUCQffK/VY4yQJjAekAGWcW/+RvKPyz0\nAEDXjVbA8CEhQCbvgUAGJn2/ZcBNQJWUhUBvFNq/k9tbQDsFhkDjMdi/acCSQLQspkCxeiu/\nLPQAQHPxVUDsDjTAw3YDQKTTRUCWXnrAGuEFQEOASUD79Kq/N/tbQAije0BDeRHAOpwNQJad\nZ0AmYpbAHCojQD0rVkAMLSTAN5fvP0B9VUCNdcW+jhISQD5QWkBzSlHAgIvxP18LMUBWWb7A\nI1I6QEMZfkBNpnzAm38eQI4IWUAsmYjAuF31P4JGT0DIG5q/CJJqv5vvPT9VDN3ArItNQLUr\njUA5RxzAak8cQA10TED7lvC/8wQ5QGBYZUBNpnzACcc9QGjIhEBZBgjAVJ8MQNqZWEDFTQ7A\nf6wyQFygc0D0KnjAhQ4ZQDdiWEDpkJjAymcPQLpefUCDhY2/eJImQBIOc0CYM4S/A8snQBn9\nZEDIsZy/iP1BQK1ggUCjLCrAFfERQPsea0As4SXA+VZ+QAY3m0BnlIw/2BxIQDUGh0CZUBXA\nT6eZPnFIiD+v4krAItMHQEQ8TUCOOo/AWOBlQG8eiUAWnpC/fOg3QD1kXEDIG5q/D2zLP6cY\nJkCS0a/AE4uMQAnSp0BcNoY+j3YSQKROQUAHyhTADdkrQOSvYUCETDDACJJqP2jIyD+ok6TA\nCJJqvwAAAAAAAAAAacCSQAAAAAAAAAAAAAAAAVDc6j8AAAAAAAAAAAAAAABB1wc/AAAAAAAA\nAADYMbFAAAAAAAAAAAEAAAAAwCxCQAAAAAAAAAAAAAAAAHJr4MAAAAAAAAAAAM1yeEAAAAAB\nAAAAAAAAAAAXZMi/QG2hQAAAAAAAAAAAAAAAAUBtoUAAAAAAAAAAAAAAAAAH6sJAAAAAAAAA\nAAEAAAAAB+rCQAAAAAAAAAAAAAAAAIuliEAAAAABAAAAAAAAAACLpYhAmZiYPpmYmD6ZmJg+\nAACAPwAAAAEBAQEAAAA="}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    // Simulate two-sided lighting\n    if (n.z < 0.0)\n      n = -n;\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i]) {\n        if (finite[i]) {\n          lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n        } else {\n          lightdir = (mvMatrix * vec4(lightdir, 0.)).xyz;\n        }\n      }\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, luminance);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n \n#endif // TEXTURE_alpha\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div class="column" style="width:48%;">
<p>PCA rotated coordinates</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display no-overflow-x">
<style>#rgl2353 {margin:auto;}</style>
<div id="rgl2353" style="width:384px;height:384px;" class="rglWebGL html-widget" role="img" aria-labelledby="rgl2353-aria"></div>
<script type="application/json" data-for="rgl2353">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":100,"objects":{"106":{"id":106,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.1295827776193619]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"107":{"id":107,"type":"lines","material":{"lit":false},"vertices":"3","colors":"4","centers":"5","ignoreExtent":false,"flags":32832},"108":{"id":108,"type":"lines","material":{"lit":false},"vertices":"6","colors":"7","centers":"8","ignoreExtent":false,"flags":32832},"109":{"id":109,"type":"lines","material":{"lit":false},"vertices":"9","colors":"10","centers":"11","ignoreExtent":false,"flags":32832},"110":{"id":110,"type":"text","material":{"lit":false},"vertices":"12","colors":"13","texts":[["PC1"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"14","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"111":{"id":111,"type":"text","material":{"lit":false},"vertices":"15","colors":"16","texts":[["PC2"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"17","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"112":{"id":112,"type":"text","material":{"lit":false},"vertices":"18","colors":"19","texts":[["PC3"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"20","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"104":{"id":104,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"103":{"id":103,"type":"background","material":{},"colors":"21","centers":"22","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"105":{"id":105,"type":"background","material":{"lit":false,"back":"lines"},"colors":"23","centers":"24","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"100":{"id":100,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":100,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,27.63776206970215],"modelMatrix":[[1,0,0,0.1457741260528564],[0,1,0,0.5288031101226807],[0,0,1,-27.68210792541504],[0,0,0,1]],"projMatrix":[[3.732050657272339,0,0,0],[0,3.732050657272339,0,0],[0,0,-3.863703489303589,-99.63093566894531],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-6.994378089904785,6.702829837799072,-2.508304357528687,1.450698137283325,-0.5440136194229126,0.6327037215232849],"windowRect":[34,57,290,313],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[105,106,107,108,109,110,111,112,104],"subscenes":[],"flags":34131}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":384,"height":384,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":54,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":54,"type":"VEC4","normalized":true},{"bufferView":2,"componentType":5126,"count":54,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":14,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":15,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":17,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":18,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":19,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":20,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":21,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":22,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":23,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":24,"componentType":5121,"count":1,"type":"VEC3"}],"bufferViews":[{"buffer":0,"byteLength":648,"byteOffset":0},{"buffer":0,"byteLength":216,"byteOffset":648},{"buffer":0,"byteLength":648,"byteOffset":864},{"buffer":0,"byteLength":24,"byteOffset":1512},{"buffer":0,"byteLength":4,"byteOffset":1536},{"buffer":0,"byteLength":12,"byteOffset":1540},{"buffer":0,"byteLength":24,"byteOffset":1552},{"buffer":0,"byteLength":4,"byteOffset":1576},{"buffer":0,"byteLength":12,"byteOffset":1580},{"buffer":0,"byteLength":24,"byteOffset":1592},{"buffer":0,"byteLength":4,"byteOffset":1616},{"buffer":0,"byteLength":12,"byteOffset":1620},{"buffer":0,"byteLength":12,"byteOffset":1632},{"buffer":0,"byteLength":4,"byteOffset":1644},{"buffer":0,"byteLength":12,"byteOffset":1648},{"buffer":0,"byteLength":12,"byteOffset":1660},{"buffer":0,"byteLength":4,"byteOffset":1672},{"buffer":0,"byteLength":12,"byteOffset":1676},{"buffer":0,"byteLength":12,"byteOffset":1688},{"buffer":0,"byteLength":4,"byteOffset":1700},{"buffer":0,"byteLength":12,"byteOffset":1704},{"buffer":0,"byteLength":16,"byteOffset":1716},{"buffer":0,"byteLength":3,"byteOffset":1732},{"buffer":0,"byteLength":4,"byteOffset":1735},{"buffer":0,"byteLength":3,"byteOffset":1739}],"buffers":[{"byteLength":1742,"bytes":"7XhUwOcn174ggSW+dylvv1T65j4yZJq+2IecvwIpQj6RRaG9Z6zbwGVUhr8M5ko9wK1PQA/L\nZ7979Wy+Ut65vjeXPz+hZDY81OsKv49LCr5IIEO++idRwFOyTL9g7+I82j29QJ5wTb9W3q++\nPF3xP4ycID2thUM+oKKdPnOGQ72G5Ak+KsEHvyTnar7LDwa+CTSGv0Iwpb2YH9M9o9TUP88T\ncr9IMNS+LYS7v/v37b6JxcQ+OO6Vv0cG1T5+q765Wu6iv85fDT8ipBG+C/M8wCE+pT/4EGO+\nR4MJP5oBUr4FGHY+Q57FP9sqiD5lr0k9yt4pv640iL8Q9608ShYvv+2DOD9KqqO+7B35P++M\niz9lZKw+gzb8PUncy7uuEQS+xs25vxpMzb8zt5U+CVRLP4sEez5ryOg95p5cQCRBiT9fcBe9\nr7ZpP/vOqD8iiMk99eLIP+QUZD8u7468WwE+v9l9mL/Ht1E+zv3CQAP2pr82ZuA+W2sjv/d5\ncj+s/D4+HVS2vntBB79aXTW+M7CIPxTTij8KViy+ySM2vyHj8j7nNyQ+MSg5vZSjxb6fTAo+\nnDF2P1KHjj//aHg976wBQLnvjD+lkCw9YnmcvymfIb+JzAA/kB6uvycHCr8EOAs+uLOPv5vm\nDL/34wi9WUt8vne+PT+lMUA9v9n8Pf0E8Tx8mpY+i4eCwKmLcL7tpaK9q+cfvwbgOT+oSdQ9\nm+MWQPk8GMBz92i+vXv5P1mFLT8/gsQ99Zjrv+ykzj61pkG+IpyXv9Yb975+3pu+/Y1PQFe9\nCz8yjxM9dr1rwPH1Mj8Hy4i92GgTPtim976xsEK+uogmPta+kD72LrW9qAJmQKjCJb8RGYG+\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n/wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD/\n7XhUwOcn174ggSW+dylvv1T65j4yZJq+2IecvwIpQj6RRaG9Z6zbwGVUhr8M5ko9wK1PQA/L\nZ7979Wy+Ut65vjeXPz+hZDY81OsKv49LCr5IIEO++idRwFOyTL9g7+I82j29QJ5wTb9W3q++\nPF3xP4ycID2thUM+oKKdPnOGQ72G5Ak+KsEHvyTnar7LDwa+CTSGv0Iwpb2YH9M9o9TUP88T\ncr9IMNS+LYS7v/v37b6JxcQ+OO6Vv0cG1T5+q765Wu6iv85fDT8ipBG+C/M8wCE+pT/4EGO+\nR4MJP5oBUr4FGHY+Q57FP9sqiD5lr0k9yt4pv640iL8Q9608ShYvv+2DOD9KqqO+7B35P++M\niz9lZKw+gzb8PUncy7uuEQS+xs25vxpMzb8zt5U+CVRLP4sEez5ryOg95p5cQCRBiT9fcBe9\nr7ZpP/vOqD8iiMk99eLIP+QUZD8u7468WwE+v9l9mL/Ht1E+zv3CQAP2pr82ZuA+W2sjv/d5\ncj+s/D4+HVS2vntBB79aXTW+M7CIPxTTij8KViy+ySM2vyHj8j7nNyQ+MSg5vZSjxb6fTAo+\nnDF2P1KHjj//aHg976wBQLnvjD+lkCw9YnmcvymfIb+JzAA/kB6uvycHCr8EOAs+uLOPv5vm\nDL/34wi9WUt8vne+PT+lMUA9v9n8Pf0E8Tx8mpY+i4eCwKmLcL7tpaK9q+cfvwbgOT+oSdQ9\nm+MWQPk8GMBz92i+vXv5P1mFLT8/gsQ99Zjrv+ykzj61pkG+IpyXv9Yb975+3pu+/Y1PQFe9\nCz8yjxM9dr1rwPH1Mj8Hy4i92GgTPtim976xsEK+uogmPta+kD72LrW9qAJmQKjCJb8RGYG+\nZ6zbwAAAAAAAAAAAzv3CQAAAAAAAAAAAAAAAAch0xb4AAAAAAAAAAAAAAAD5PBjAAAAAAAAA\nAAD7zqg/AAAAAAAAAAEAAAAA96oHvwAAAAAAAAAAAAAAAEgw1L4AAAAAAAAAAInMAD8AAAAB\nAAAAAAAAAAAoozU9lX3WQAAAAAAAAAAAAAAAAZV91kAAAAAAAAAAAAAAAAB6sLk/AAAAAAAA\nAAEAAAAAerC5PwAAAAAAAAAAAAAAAMqtDT8AAAABAAAAAAAAAADKrQ0/mZiYPpmYmD6ZmJg+\nAACAPwAAAAEBAQEAAAA="}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    // Simulate two-sided lighting\n    if (n.z < 0.0)\n      n = -n;\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i]) {\n        if (finite[i]) {\n          lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n        } else {\n          lightdir = (mvMatrix * vec4(lightdir, 0.)).xyz;\n        }\n      }\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, luminance);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n \n#endif // TEXTURE_alpha\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<p><br></p>
<ul>
<li>This slide contains interactive 3D graphics, that can be rotated with the mouse.</li>
<li>Rotate the left image, so that the points on both size show similar patterns.</li>
<li>Rotate the right image to show PC 3</li>
</ul>
<p><span class="math inline">\(\rightarrow\)</span> Most of the 3D information of the data can be vizualized in 2D.</p>
<p>Note: log-transformed variables were used in this example.</p>
</section>
<section id="pca-is-an-orthogonal-model-ii-regression" class="slide level2">
<h2>PCA is an orthogonal (model II) regression</h2>
<div class="column" style="width:32%;">
<p><br></p>
<ul>
<li>PC1, PC2, PC3 are the principal components</li>
<li>OLS is ordinary least squares regression (linear model lm)</li>
</ul>
</div>
<div class="column" style="width:66%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="11-multivariate-1_files/figure-revealjs/orthogonal-regression-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="now-analyse-all-numeric-variables" class="slide level2">
<h2>Now analyse all numeric variables</h2>
<p><small></small></p><small>
<div class="cell">
<div class="cell-output-display">
<table style="width:100%;">
<colgroup>
<col style="width: 8%">
<col style="width: 26%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">shortname</th>
<th style="text-align: right;">z_mean</th>
<th style="text-align: right;">z_max</th>
<th style="text-align: right;">t_ret</th>
<th style="text-align: right;">volume</th>
<th style="text-align: right;">area</th>
<th style="text-align: right;">p_tot</th>
<th style="text-align: right;">n_no3</th>
<th style="text-align: right;">chl</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ammer</td>
<td style="text-align: left;">Ammersee</td>
<td style="text-align: left;">Ammer</td>
<td style="text-align: right;">37.60</td>
<td style="text-align: right;">81.1</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">1.75000</td>
<td style="text-align: right;">46.600</td>
<td style="text-align: right;">7.3</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">2.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arend</td>
<td style="text-align: left;">Arendsee</td>
<td style="text-align: left;">Arend</td>
<td style="text-align: right;">28.60</td>
<td style="text-align: right;">48.7</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: right;">0.14700</td>
<td style="text-align: right;">5.140</td>
<td style="text-align: right;">375.0</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">22.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Boden</td>
<td style="text-align: left;">Bodensee</td>
<td style="text-align: left;">Boden</td>
<td style="text-align: right;">85.00</td>
<td style="text-align: right;">254.0</td>
<td style="text-align: right;">4.20</td>
<td style="text-align: right;">48.52150</td>
<td style="text-align: right;">571.500</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">2.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chiem</td>
<td style="text-align: left;">Chiemsee</td>
<td style="text-align: left;">Chiem</td>
<td style="text-align: right;">25.60</td>
<td style="text-align: right;">73.4</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">2.04800</td>
<td style="text-align: right;">79.900</td>
<td style="text-align: right;">9.2</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">3.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dober</td>
<td style="text-align: left;">Dobersdorfer See</td>
<td style="text-align: left;">Dober</td>
<td style="text-align: right;">5.40</td>
<td style="text-align: right;">18.8</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">0.01690</td>
<td style="text-align: right;">3.120</td>
<td style="text-align: right;">63.9</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">27.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Muegg</td>
<td style="text-align: left;">Großer Müggelsee</td>
<td style="text-align: left;">Muegg</td>
<td style="text-align: right;">4.85</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.03500</td>
<td style="text-align: right;">7.200</td>
<td style="text-align: right;">189.9</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">32.90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ploen</td>
<td style="text-align: left;">Großer Plöner See</td>
<td style="text-align: left;">Ploen</td>
<td style="text-align: right;">12.40</td>
<td style="text-align: right;">58.0</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">0.37200</td>
<td style="text-align: right;">29.970</td>
<td style="text-align: right;">62.3</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">8.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kumme</td>
<td style="text-align: left;">Kummerower See</td>
<td style="text-align: left;">Kumme</td>
<td style="text-align: right;">8.10</td>
<td style="text-align: right;">23.3</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">0.26300</td>
<td style="text-align: right;">32.500</td>
<td style="text-align: right;">65.3</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">16.60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mueritz</td>
<td style="text-align: left;">Müritz (Außenmüritz)</td>
<td style="text-align: left;">Mueritz</td>
<td style="text-align: right;">6.50</td>
<td style="text-align: right;">28.1</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">0.68000</td>
<td style="text-align: right;">105.300</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">6.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">MuerB</td>
<td style="text-align: left;">Müritz (Binnenmüritz)</td>
<td style="text-align: left;">MuerB</td>
<td style="text-align: right;">9.80</td>
<td style="text-align: right;">30.3</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">0.03800</td>
<td style="text-align: right;">3.910</td>
<td style="text-align: right;">34.2</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">6.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Plaue</td>
<td style="text-align: left;">Plauer See</td>
<td style="text-align: left;">Plaue</td>
<td style="text-align: right;">6.80</td>
<td style="text-align: right;">25.5</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">0.30000</td>
<td style="text-align: right;">38.400</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">6.80</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sacro</td>
<td style="text-align: left;">Sacrower See</td>
<td style="text-align: left;">Sacro</td>
<td style="text-align: right;">18.01</td>
<td style="text-align: right;">36.0</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">0.01930</td>
<td style="text-align: right;">1.072</td>
<td style="text-align: right;">79.8</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">8.60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Schar</td>
<td style="text-align: left;">Scharmützelsee</td>
<td style="text-align: left;">Schar</td>
<td style="text-align: right;">9.00</td>
<td style="text-align: right;">29.5</td>
<td style="text-align: right;">16.00</td>
<td style="text-align: right;">0.10823</td>
<td style="text-align: right;">12.090</td>
<td style="text-align: right;">35.3</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">10.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">SchwA</td>
<td style="text-align: left;">Schweriner See (Außensee)</td>
<td style="text-align: left;">SchwA</td>
<td style="text-align: right;">9.40</td>
<td style="text-align: right;">52.4</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">0.33100</td>
<td style="text-align: right;">35.200</td>
<td style="text-align: right;">100.0</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">11.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SchwI</td>
<td style="text-align: left;">Schweriner See (Innensee)</td>
<td style="text-align: left;">SchwI</td>
<td style="text-align: right;">13.50</td>
<td style="text-align: right;">44.6</td>
<td style="text-align: right;">5.30</td>
<td style="text-align: right;">0.35600</td>
<td style="text-align: right;">26.400</td>
<td style="text-align: right;">246.5</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">5.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Starn</td>
<td style="text-align: left;">Starnberger See</td>
<td style="text-align: left;">Starn</td>
<td style="text-align: right;">53.20</td>
<td style="text-align: right;">127.8</td>
<td style="text-align: right;">21.00</td>
<td style="text-align: right;">2.99900</td>
<td style="text-align: right;">56.400</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">1.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stech</td>
<td style="text-align: left;">Stechlinsee</td>
<td style="text-align: left;">Stech</td>
<td style="text-align: right;">22.80</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">32.00</td>
<td style="text-align: right;">0.09700</td>
<td style="text-align: right;">4.250</td>
<td style="text-align: right;">15.8</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">2.60</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stein</td>
<td style="text-align: left;">Steinhuder Meer</td>
<td style="text-align: left;">Stein</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">0.04200</td>
<td style="text-align: right;">29.100</td>
<td style="text-align: right;">53.3</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">29.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</small><p><small></small></p>
<ul>
<li>columns: called <strong>variables</strong> or <strong>species</strong></li>
<li>rows: <strong>observations</strong> or <strong>objects</strong></li>
</ul>
</section>
<section id="pca-with-the-uba-lake-data" class="slide level2">
<h2>PCA with the UBA lake data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">scale</span>(lakedata))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Eigenvalues (proportion of variance) indicate importance of components.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2   PC3     PC4    PC5     PC6     PC7     PC8
Standard deviation     2.0692 1.2735 1.047 0.76067 0.5499 0.30497 0.12230 0.10618
Proportion of Variance 0.5352 0.2027 0.137 0.07233 0.0378 0.01163 0.00187 0.00141
Cumulative Proportion  0.5352 0.7379 0.875 0.94729 0.9851 0.99672 0.99859 1.00000</code></pre>
</div>
</div>

<img data-src="11-multivariate-1_files/figure-revealjs/uba-pca-variance-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="pca-biplot" class="slide level2">
<h2>PCA Biplot</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="11-multivariate-1_files/figure-revealjs/pca-biplot1-1.png" class="quarto-figure quarto-figure-center r-stretch" width="576"></section>
<section id="pca-with-sqrt-transformed-data" class="slide level2">
<h2>PCA with sqrt transformed data</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a aria-hidden="true" tabindex="-1"></a>lakedata2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lakedata)</span>
<span id="cb12-2"><a aria-hidden="true" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">scale</span>(lakedata2))</span>
<span id="cb12-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                         PC1    PC2    PC3     PC4     PC5     PC6     PC7    PC8
Standard deviation     2.111 1.3059 0.9748 0.70830 0.50321 0.29742 0.17060 0.1266
Proportion of Variance 0.557 0.2132 0.1188 0.06271 0.03165 0.01106 0.00364 0.0020
Cumulative Proportion  0.557 0.7702 0.8889 0.95165 0.98330 0.99436 0.99800 1.0000</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>The PCA with the untransformed data looked very asymmetric, we repeat it with square root transformed data.</li>
<li>helps to get a better “resolution”</li>
<li>must be taken into account when interpreting the results</li>
<li>log transformation is also possible</li>
</ul>
</section>
<section id="biplot-of-sqrt-transformed-data-1.-3.-pc" class="slide level2">
<h2>Biplot of sqrt transformed data (1.-3. PC)</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">2.4</span>), <span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb14-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pc)</span>
<span id="cb14-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pc, <span class="at">choices=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="11-multivariate-1_files/figure-revealjs/uba-pca-biplot-1.png" class="quarto-figure quarto-figure-center r-stretch" width="1152"></section>
<section id="pca-with-the-vegan-package" class="slide level2">
<h2>PCA with the vegan package</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">rda</span>(lakedata2, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(X = lakedata2, scale = TRUE) 

Partitioning of correlations:
              Inertia Proportion
Total               8          1
Unconstrained       8          1

Eigenvalues, and their contribution to the correlations 

Importance of components:
                        PC1    PC2    PC3     PC4     PC5     PC6      PC7      PC8
Eigenvalue            4.456 1.7053 0.9503 0.50170 0.25322 0.08846 0.029105 0.016020
Proportion Explained  0.557 0.2132 0.1188 0.06271 0.03165 0.01106 0.003638 0.002003
Cumulative Proportion 0.557 0.7702 0.8889 0.95165 0.98330 0.99436 0.997997 1.000000</code></pre>
</div>
</div>
<!---
summary(pc3)$cont$importance # trick to suppress long output
--->
<p>The two first PCs explain PC 1 = 77% of variance of the square root transformed observations.</p>
</section>
<section id="variance-importance-and-biplot" class="slide level2">
<h2>Variance importance and biplot</h2>
<div class="column" style="width:49%;">
<p><strong>Importance of components</strong></p>
<ul>
<li>PC 1 = 56%</li>
<li>PC 2 = 21%</li>
<li>PC 3 = 12%</li>
</ul>
<p><span class="math inline">\(\Rightarrow\)</span> The two first PCs explain PC 1 = 77% of variance of the square root transformed observations.</p>
</div>
<div class="column" style="width:49%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="11-multivariate-1_files/figure-revealjs/uba-rda-biplot-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="interpretation" class="slide level2">
<h2>Interpretation</h2>
<div class="column" style="width:69%;">
<p><strong>Variables</strong></p>
<ul>
<li>only long arrows can be interpreted</li>
<li>same direction: positive correlation</li>
<li>opposite direction: negative correlation</li>
<li>rectangular: no correlation</li>
</ul>
<p><strong>Observations</strong></p>
<ul>
<li>identification of groups and extreme cases</li>
</ul>
<p><strong>Combined View</strong></p>
<ul>
<li>relative size of variable for observations</li>
<li>arrow direction: high values</li>
<li>opposite direction: low values</li>
<li>around middle: average</li>
</ul>
<p><span class="math inline">\(\Rightarrow\)</span> <span class="red">Important: always read perpendicular to PCs and arrows!</span></p>
</div>
<div class="column" style="width:29%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="11-multivariate-1_files/figure-revealjs/pca-interpretation-1.png" width="240"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="biplot-in-3d" class="slide level2">
<h2>Biplot in 3D</h2>
<div class="column" style="width:29%;">
<p><br></p>
<p><strong>Variance</strong></p>
<ul>
<li>PC 1 = 56%</li>
<li>PC 2 = 21%</li>
<li>PC 3 = 12%</li>
<li>sum of PC 4 … 8 = 11%</li>
</ul>
<p><br></p>
<p><span class="math inline">\(\rightarrow\)</span> Use the mouse to rotate and zoom.</p>
</div>
<div class="column" style="width:69%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display no-overflow-x">
<style>#rgl472 {margin:auto;}</style>
<div id="rgl472" style="width:480px;height:480px;" class="rglWebGL html-widget" role="img" aria-labelledby="rgl472-aria"></div>
<script type="application/json" data-for="rgl472">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":187,"objects":{"193":{"id":193,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.03550074249505997]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"194":{"id":194,"type":"lines","material":{"lit":false},"vertices":"3","colors":"4","centers":"5","ignoreExtent":false,"flags":32832},"195":{"id":195,"type":"lines","material":{"lit":false},"vertices":"6","colors":"7","centers":"8","ignoreExtent":false,"flags":32832},"196":{"id":196,"type":"lines","material":{"lit":false},"vertices":"9","colors":"10","centers":"11","ignoreExtent":false,"flags":32832},"197":{"id":197,"type":"text","material":{"lit":false},"vertices":"12","colors":"13","texts":[["PC1"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"14","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"198":{"id":198,"type":"text","material":{"lit":false},"vertices":"15","colors":"16","texts":[["PC2"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"17","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"199":{"id":199,"type":"text","material":{"lit":false},"vertices":"18","colors":"19","texts":[["PC3"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"20","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"200":{"id":200,"type":"text","material":{"lit":false},"vertices":"21","colors":"22","texts":[["z_mean"],["z_max"],["t_ret"],["volume"],["area"],["p_tot"],["n_no3"],["chl"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"23","family":[["sans"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"201":{"id":201,"type":"text","material":{"lit":false},"vertices":"24","colors":"25","texts":[["Ammer"],["Arend"],["Boden"],["Chiem"],["Dober"],["Muegg"],["Ploen"],["Kumme"],["Mueritz"],["MuerB"],["Plaue"],["Sacro"],["Schar"],["SchwA"],["SchwI"],["Starn"],["Stech"],["Stein"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"26","family":[["sans"]],"font":[[1]],"pos":[[4]],"ignoreExtent":false,"flags":33808},"191":{"id":191,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"190":{"id":190,"type":"background","material":{},"colors":"27","centers":"28","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"192":{"id":192,"type":"background","material":{"lit":false,"back":"lines"},"colors":"29","centers":"30","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"187":{"id":187,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":187,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,11.18982315063477],"modelMatrix":[[0.9961947202682495,0,-0.08715573698282242,0.7256224155426025],[-0.02255756407976151,0.9659258127212524,-0.2578341662883759,-0.5405616760253906],[0.08418597280979156,0.258819043636322,0.9622501730918884,-10.89042949676514],[0,0,0,1]],"projMatrix":[[3.732050657272339,0,0,0],[0,3.732050657272339,0,0],[0,0,-3.863703489303589,-40.33802032470703],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[0.9961947202682495,0,-0.08715573698282242,0],[-0.02255756407976151,0.9659258127212524,-0.2578341662883759,0],[0.08418597280979156,0.258819043636322,0.9622501730918884,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-2.60221529006958,1.081695795059204,-1.114728927612305,2.00403618812561,-1.965209007263184,1.236758947372437],"windowRect":[164,187,420,443],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"TT Arial","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[192,193,194,195,196,197,198,199,200,201,191],"subscenes":[],"flags":34131}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":480,"height":480,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":18,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":18,"type":"VEC4","normalized":true},{"bufferView":2,"componentType":5126,"count":18,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":2,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":14,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":15,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":17,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":18,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":19,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":20,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":21,"componentType":5126,"count":8,"type":"VEC3"},{"bufferView":22,"componentType":5121,"count":8,"type":"VEC4","normalized":true},{"bufferView":23,"componentType":5126,"count":8,"type":"VEC3"},{"bufferView":24,"componentType":5126,"count":18,"type":"VEC3"},{"bufferView":25,"componentType":5121,"count":18,"type":"VEC4","normalized":true},{"bufferView":26,"componentType":5126,"count":18,"type":"VEC3"},{"bufferView":27,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":28,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":29,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":30,"componentType":5121,"count":1,"type":"VEC3"}],"bufferViews":[{"buffer":0,"byteLength":216,"byteOffset":0},{"buffer":0,"byteLength":72,"byteOffset":216},{"buffer":0,"byteLength":216,"byteOffset":288},{"buffer":0,"byteLength":24,"byteOffset":504},{"buffer":0,"byteLength":4,"byteOffset":528},{"buffer":0,"byteLength":12,"byteOffset":532},{"buffer":0,"byteLength":24,"byteOffset":544},{"buffer":0,"byteLength":4,"byteOffset":568},{"buffer":0,"byteLength":12,"byteOffset":572},{"buffer":0,"byteLength":24,"byteOffset":584},{"buffer":0,"byteLength":4,"byteOffset":608},{"buffer":0,"byteLength":12,"byteOffset":612},{"buffer":0,"byteLength":12,"byteOffset":624},{"buffer":0,"byteLength":4,"byteOffset":636},{"buffer":0,"byteLength":12,"byteOffset":640},{"buffer":0,"byteLength":12,"byteOffset":652},{"buffer":0,"byteLength":4,"byteOffset":664},{"buffer":0,"byteLength":12,"byteOffset":668},{"buffer":0,"byteLength":12,"byteOffset":680},{"buffer":0,"byteLength":4,"byteOffset":692},{"buffer":0,"byteLength":12,"byteOffset":696},{"buffer":0,"byteLength":96,"byteOffset":708},{"buffer":0,"byteLength":32,"byteOffset":804},{"buffer":0,"byteLength":96,"byteOffset":836},{"buffer":0,"byteLength":216,"byteOffset":932},{"buffer":0,"byteLength":72,"byteOffset":1148},{"buffer":0,"byteLength":216,"byteOffset":1220},{"buffer":0,"byteLength":16,"byteOffset":1436},{"buffer":0,"byteLength":3,"byteOffset":1452},{"buffer":0,"byteLength":4,"byteOffset":1455},{"buffer":0,"byteLength":3,"byteOffset":1459}],"buffers":[{"byteLength":1462,"bytes":"IspWv/qDG7/YZAQ/yP8dP2oy6T+uAPe/DUUkwBb/nL4s+Ki/7qklvxB/F79tPA4/uXkUPylf\ngL+iOra+eL17P3FiXr/XBYS/yd5SPd0VN745QP49MitPPiYkir8nhpi+TOGTPJSxL76jzDE/\nLWqlPruD6j1dgVU/vflePnBVbL5w5k4/KFTPPtpoUj9V7pQ+b0auPjrJyj5WUQE/LpNEPv1/\n/j2sn5y+IZZ6Pp6Scz6hMDK/XoJ0v1PiaT9SwA0/owROvUCCtz/t6Y8/ChFiP2FrU79W4ZC9\n//8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////\nAP///wD///8A////AP///wD/IspWv/qDG7/YZAQ/yP8dP2oy6T+uAPe/DUUkwBb/nL4s+Ki/\n7qklvxB/F79tPA4/uXkUPylfgL+iOra+eL17P3FiXr/XBYS/yd5SPd0VN745QP49MitPPiYk\nir8nhpi+TOGTPJSxL76jzDE/LWqlPruD6j1dgVU/vflePnBVbL5w5k4/KFTPPtpoUj9V7pQ+\nb0auPjrJyj5WUQE/LpNEPv1//j2sn5y+IZZ6Pp6Scz6hMDK/XoJ0v1PiaT9SwA0/owROvUCC\ntz/t6Y8/ChFiP2FrU79W4ZC9DUUkwAAAAAAAAAAAeL17PwAAAAAAAAAAAQAAAV6rSr8AAAAA\nAAAAAAAAAAAmJIq/AAAAAAAAAABqMuk/AAAAAAEAAAEAAAAAiBy+PgAAAAAAAAAAAAAAAK4A\n978AAAAAAAAAAO3pjz8BAAABAAAAAAAAAACCLc6+AnWKPwAAAAAAAAAAAQAAAQJ1ij8AAAAA\nAAAAAAAAAAAhQgBAAAAAAAEAAAEAAAAAIUIAQAAAAAAAAAAAAAAAAB5Onj8BAAABAAAAAAAA\nAAAeTp4/KqeHv/+V2z6PMVi+zt+Qv/YWrz5rP/i9fn4DPfiXkz93lZm9u5eMv0gY3L33i7q+\nPraEvwtQkr6wjYG+Cog3Pysylj4z41q/rlM0v1dLO79P2Tm+oM1kP8YnwL4Gghm//wAA//8A\nAP//AAD//wAA//8AAP//AAD//wAA//8AAP8qp4e//5XbPo8xWL7O35C/9havPms/+L1+fgM9\n+JeTP3eVmb27l4y/SBjcvfeLur4+toS/C1CSvrCNgb4KiDc/KzKWPjPjWr+uUzS/V0s7v0/Z\nOb6gzWQ/xifAvgaCGb8iyla/+oMbv9hkBD/I/x0/ajLpP64A978NRSTAFv+cviz4qL/uqSW/\nEH8Xv208Dj+5eRQ/KV+Av6I6tr54vXs/cWJev9cFhL/J3lI93RU3vjlA/j0yK08+JiSKvyeG\nmL5M4ZM8lLEvvqPMMT8taqU+u4PqPV2BVT+9+V4+cFVsvnDmTj8oVM8+2mhSP1XulD5vRq4+\nOsnKPlZRAT8uk0Q+/X/+PayfnL4hlno+npJzPqEwMr9egnS/U+JpP1LADT+jBE69QIK3P+3p\njz8KEWI/YWtTv1bhkL0AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8AAP//\nAAD//wAA//8AAP//AAD//wAA//8AAP//AAD//wAA//8iyla/+oMbv9hkBD/I/x0/ajLpP64A\n978NRSTAFv+cviz4qL/uqSW/EH8Xv208Dj+5eRQ/KV+Av6I6tr54vXs/cWJev9cFhL/J3lI9\n3RU3vjlA/j0yK08+JiSKvyeGmL5M4ZM8lLEvvqPMMT8taqU+u4PqPV2BVT+9+V4+cFVsvnDm\nTj8oVM8+2mhSP1XulD5vRq4+OsnKPlZRAT8uk0Q+/X/+PayfnL4hlno+npJzPqEwMr9egnS/\nU+JpP1LADT+jBE69QIK3P+3pjz8KEWI/YWtTv1bhkL2ZmJg+mZiYPpmYmD4AAIA/AAAAAQEB\nAQAAAA=="}]},"context":{"shiny":false,"rmarkdown":null},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    // Simulate two-sided lighting\n    if (n.z < 0.0)\n      n = -n;\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i]) {\n        if (finite[i]) {\n          lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n        } else {\n          lightdir = (mvMatrix * vec4(lightdir, 0.)).xyz;\n        }\n      }\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, luminance);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*luminance);\n#endif\n \n#endif // TEXTURE_alpha\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</section>
<section id="nonmetric-multidimensional-scaling-nmds" class="slide level2">
<h2>Nonmetric Multidimensional Scaling: NMDS</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" tabindex="-1"></a>md <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(lakedata2, <span class="at">scale =</span> <span class="cn">TRUE</span>, <span class="at">distance =</span> <span class="st">"euclid"</span>, <span class="at">trace=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(md, <span class="at">type=</span><span class="st">"text"</span>)</span>
<span id="cb18-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey"</span>, <span class="at">lty=</span><span class="st">"dotted"</span>)</span>
<span id="cb18-4"><a aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey"</span>, <span class="at">lty=</span><span class="st">"dotted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="11-multivariate-1_files/figure-revealjs/uba-nmds-1.png" class="quarto-figure quarto-figure-center r-stretch" width="480"><p>The NMDS tries to map the higher dimensions even better to 2D or 3D. However, it accepts some distortion. More about this in the next chapter.</p>
</section>
<section id="the-code" class="slide level2">
<h2>The code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a>lakes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/tpetzoldt/elements/main/data/uba/lakes-combined-data.csv"</span>)</span>
<span id="cb19-2"><a aria-hidden="true" tabindex="-1"></a>valid_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"shortname"</span>, <span class="st">"z_mean"</span>, <span class="st">"z_max"</span>,  <span class="st">"t_ret"</span>, <span class="st">"volume"</span>, </span>
<span id="cb19-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="st">"area"</span>, <span class="st">"p_tot"</span>, <span class="st">"n_no3"</span>, <span class="st">"chl"</span>, <span class="st">"wfd_type"</span>)</span>
<span id="cb19-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># set row names and limit data set to complete records without missing data</span></span>
<span id="cb19-6"><a aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(lakes) <span class="ot">&lt;-</span> lakes<span class="sc">$</span>shortname</span>
<span id="cb19-7"><a aria-hidden="true" tabindex="-1"></a>lakes <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(lakes[valid_columns])</span>
<span id="cb19-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># only the numerical variables</span></span>
<span id="cb19-10"><a aria-hidden="true" tabindex="-1"></a>lakedata <span class="ot">&lt;-</span> lakes[<span class="fu">c</span>(<span class="st">"z_mean"</span>, <span class="st">"z_max"</span>,  <span class="st">"t_ret"</span>, <span class="st">"volume"</span>, </span>
<span id="cb19-11"><a aria-hidden="true" tabindex="-1"></a>                     <span class="st">"area"</span>, <span class="st">"p_tot"</span>, <span class="st">"n_no3"</span>, <span class="st">"chl"</span>)] </span>
<span id="cb19-12"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a aria-hidden="true" tabindex="-1"></a><span class="do">## PCA with the vegan package</span></span>
<span id="cb19-14"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"vegan"</span>)</span>
<span id="cb19-15"><a aria-hidden="true" tabindex="-1"></a>lakedata2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lakedata)</span>
<span id="cb19-16"><a aria-hidden="true" tabindex="-1"></a>pc <span class="ot">&lt;-</span> <span class="fu">rda</span>(lakedata2, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-17"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pc)</span>
<span id="cb19-18"><a aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pc)</span>
<span id="cb19-19"><a aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pc, <span class="at">choices=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb19-20"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a aria-hidden="true" tabindex="-1"></a><span class="do">## 3D Plot</span></span>
<span id="cb19-22"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"vegan3d"</span>)</span>
<span id="cb19-23"><a aria-hidden="true" tabindex="-1"></a><span class="fu">ordirgl</span>(pc, <span class="at">col =</span> <span class="st">"yellow"</span>)</span>
<span id="cb19-24"><a aria-hidden="true" tabindex="-1"></a><span class="fu">orgltext</span>(pc, <span class="at">display =</span> <span class="st">"species"</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb19-25"><a aria-hidden="true" tabindex="-1"></a><span class="fu">orgltext</span>(pc, <span class="at">display =</span> <span class="st">"sites"</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb19-26"><a aria-hidden="true" tabindex="-1"></a><span class="fu">view3d</span>(<span class="at">theta =</span> <span class="dv">5</span>, <span class="at">phi =</span> <span class="dv">15</span>, <span class="at">fov=</span><span class="dv">30</span>, <span class="at">zoom=</span><span class="dv">1</span>)</span>
<span id="cb19-27"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a aria-hidden="true" tabindex="-1"></a><span class="do">## NMDS</span></span>
<span id="cb19-29"><a aria-hidden="true" tabindex="-1"></a>md <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(lakedata2, <span class="at">scale =</span> <span class="cn">TRUE</span>, <span class="at">distance =</span> <span class="st">"euclid"</span>, <span class="at">trace=</span><span class="cn">FALSE</span>)</span>
<span id="cb19-30"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(md, <span class="at">type=</span><span class="st">"text"</span>)</span>
<span id="cb19-31"><a aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey"</span>, <span class="at">lty=</span><span class="st">"dotted"</span>)</span>
<span id="cb19-32"><a aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey"</span>, <span class="at">lty=</span><span class="st">"dotted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Data and full source code is available from <a href="https://github.com/tpetzoldt/elements/">https://github.com/tpetzoldt/elements/</a></li>
</ul>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<p><br></p>
<ul>
<li>Multivariate methods can be used to analyze data sets, where multiple variables depend on each other.</li>
<li>PCA is a dimension reduction technique that tries to map high-dimensional data to a lower number of dimensions.</li>
<li>It can be used as an <strong>explorative</strong> technique to find relationships between data.</li>
<li>Compared to creating multiple plots between all variables, it helps to see the overall picture, saves time and avoids statistical fishing.</li>
<li>The next chapter will introduce more methods.</li>
</ul>
<p><br></p>
<p><strong>Further reading</strong></p>
<ul>
<li><span class="citation" data-cites="oksanen_multivariate_2010">Oksanen (<a href="#/references" role="doc-biblioref" onclick="">2010</a>)</span></li>
<li><span class="citation" data-cites="borcard_numerical_2018">Borcard et al. (<a href="#/references" role="doc-biblioref" onclick="">2018</a>)</span></li>
</ul>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<p><br></p>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><span style="color: white; font-size: small; font-weight:400; float: right; margin-top: 40px; margin-right: 4%;"> <a href="../">🏠 Home</a> </span></p>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-borcard_numerical_2018" class="csl-entry" role="listitem">
Borcard, D., Gillet, F., &amp; Legendre, P. (2018). <em>Numerical ecology with <span>R</span></em>. Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-71404-2">https://doi.org/10.1007/978-3-319-71404-2</a>
</div>
<div id="ref-oksanen_multivariate_2010" class="csl-entry" role="listitem">
Oksanen, J. (2010). <em>Multivariate analysis of ecological communities in <span>R</span>: Vegan tutorial</em>.
</div>
<div id="ref-UBA2020" class="csl-entry" role="listitem">
Umweltbundesamt. (2021). <em><span class="nocase">Kenndaten ausgewählter Seen Deutschlands</span></em>. <a href="https://www.umweltbundesamt.de/daten/wasser/zustand-der-seen#okologischer-zustand-der-seen">https://www.umweltbundesamt.de/daten/wasser/zustand-der-seen#okologischer-zustand-der-seen</a>
</div>
<div id="ref-winkelmann_fish_2011" class="csl-entry" role="listitem">
Winkelmann, C., Hellmann, C., Worischka, S., Petzoldt, T., &amp; Benndorf, J. (2011). Fish predation affects the structure of a benthic community. <em>Freshwater Biology</em>, <em>56</em>(6), 1030–1046. <a href="https://doi.org/10.1111/j.1365-2427.2010.02543.x">https://doi.org/10.1111/j.1365-2427.2010.02543.x</a>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>